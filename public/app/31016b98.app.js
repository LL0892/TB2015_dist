"use strict";angular.module("tbApp",["ngCookies","ngResource","ngSanitize","ui.router","ui.bootstrap","ngAnimate","ezfb","LocalStorageModule","ui.calendar"]).constant("Urls",{client:"/assets/images/",api:"https://directhaircut.ch/api/",img:"http://localhost:9000/server/img/"}).config(["$logProvider",function(a){a.debugEnabled(!1)}]).config(["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider",function(a,b,c,d){b.otherwise("/"),c.html5Mode(!0),d.interceptors.push("authInterceptor")}]).config(["ezfbProvider",function(a){a.setInitParams({appId:"1435864036716003",version:"v2.3"}),a.setLocale("fr_CH")}]).config(["localStorageServiceProvider",function(a){a.setPrefix("tb2015").setStorageType("localStorage").setNotify(!0,!0)}]).factory("authInterceptor",["$rootScope","$q","$cookieStore","$location",function(a,b,c,d){return{request:function(a){return a.headers=a.headers||{},c.get("token")&&(a.headers.Authorization="Bearer "+c.get("token")),a},responseError:function(a){return 401===a.status?(d.path("/login"),c.remove("token"),b.reject(a)):b.reject(a)}}}]).run(["$rootScope","$location","Auth",function(a,b,c){a.$on("$stateChangeStart",function(a,d){c.isLoggedIn(function(a){d.authenticate&&!a&&b.path("/login")})})}]),angular.module("tbApp").config(["$stateProvider",function(a){a.state("login",{url:"/login",templateUrl:"app/account/login/login.html",controller:"LoginCtrl"}).state("signup",{url:"/signup",templateUrl:"app/account/signup/signup.html",controller:"SignupCtrl"}).state("settings",{url:"/settings",templateUrl:"app/account/settings/settings.html",controller:"SettingsCtrl",authenticate:!0}).state("notifs",{url:"/notifs",templateUrl:"app/account/notifs/notifs.html",controller:"NotifsCtrl",authenticate:!0}).state("createBusiness",{url:"/createBusiness",templateUrl:"app/account/business/business.html",controller:"BusinessCtrl",authenticate:!0}).state("createStaff",{url:"/createStaff",templateUrl:"app/account/staff/staff.html",controller:"StaffCtrl",authenticate:!0}).state("myRendezvous",{url:"/myRendezvous",templateUrl:"app/account/rdv/rdv.html",controller:"MyRendezvousCtrl",authenticate:!0})}]);var App=angular.module("tbApp");App.controller("BusinessCtrl",["$scope","$http","$state","$log","Urls",function(a,b,c,d,e){a.business={},a.geodatas={},b.get(e.api+"geodatas").then(function(b){return a.geodatas=b.data.geodatas,a.geodatas},function(b){a.error=b}),a.register=function(f){if(a.submitted=!0,d.debug(f),f.$valid){var g={name:a.business.name,city:a.business.loc.Commune,zip:a.business.loc.NPA,canton:a.business.loc.Canton,street:a.business.street,email:a.business.email,mobile:a.business.mobile,phone:a.business.phone,siteURL:a.business.siteURL,facebookURL:a.business.facebookURL};b.post(e.api+"businesses",g).then(function(){c.go("main")})["catch"](function(b){b=b.data,a.errors={},angular.forEach(b.errors,function(b,c){f[c].$setValidity("mongoose",!1),a.errors[c]=b.message})})}}}]),angular.module("tbApp").controller("LoginCtrl",["$scope","Auth","$location","$window",function(a,b,c,d){a.user={},a.errors={},a.login=function(d){a.submitted=!0,d.$valid&&b.login({email:a.user.email,password:a.user.password}).then(function(){c.path("/")})["catch"](function(b){a.errors.other=b.message})},a.loginOauth=function(a){d.location.href="/auth/"+a}}]);var App=angular.module("tbApp");App.controller("NotifsCtrl",["$scope","$http","$log","Notification",function(a,b,c,d){function e(a){return"not processed"===a?a="non traitée":"accepted"===a?a="acceptée":"refused"===a?a="refusée":void 0}a.notifications=[],b.get("/api/notifications").success(function(b){a.notifications=b.notifications;for(var d=a.notifications.length-1;d>=0;d--)a.notifications[d].statusParsed=e(a.notifications[d].status);c.debug(a.notifications)}),a.accept=function(b,c){d.acceptNotification(b._id,function(b){a.message=b.message,a.notifications[c].statusParsed="acceptée",a.notifications[c].status="accepted"},function(b){a.error=b})},a.refuse=function(b,e){d.refuseNotification(b._id,function(b){a.message=b.message,a.notifications[e].statusParsed="refusée",a.notifications[e].status="refused",c.debug(a.notifications)},function(b){a.error=b})}}]),angular.module("tbApp").controller("MyRendezvousCtrl",["$scope","$log","$http","$timeout","Urls",function(a,b,c,d,e){c.get(e.api+"rendezvous").success(function(c){b.debug(c),a.rendezvous=c})}]),angular.module("tbApp").controller("SettingsCtrl",["$scope","User","Auth",function(a,b,c){a.errors={},a.changePassword=function(b){a.submitted=!0,b.$valid&&c.changePassword(a.user.oldPassword,a.user.newPassword).then(function(){a.message="Password successfully changed."})["catch"](function(){b.password.$setValidity("mongoose",!1),a.errors.other="Incorrect password",a.message=""})}}]);var App=angular.module("tbApp");App.controller("SignupCtrl",["$scope","$log","$state","$window","$http","Urls","Auth",function(a,b,c,d,e,f,g){a.user={},a.errors={},a.localites={},e.get(f.api+"geodatas").then(function(b){return a.geodatas=b.data.geodatas,a.geodatas},function(b){a.error=b}),a.register=function(d){a.submitted=!0,b.debug(a.user),d.$valid&&(b.debug(d.$valid),a.user.manager?g.createManager({firstName:a.user.firstName,lastName:a.user.lastName,email:a.user.email,password:a.user.password,dateOfBirth:a.user.dateOfBirth,gender:a.user.gender,city:a.user.loc.Commune,zip:a.user.loc.NPA,canton:a.user.loc.Canton}).then(function(){c.go("main")})["catch"](function(b){b=b.data,a.errors={},angular.forEach(b.errors,function(b,c){d[c].$setValidity("mongoose",!1),a.errors[c]=b.message})}):g.createUser({firstName:a.user.firstName,lastName:a.user.lastName,email:a.user.email,password:a.user.password,dateOfBirth:a.user.dateOfBirth,gender:a.user.gender,city:a.user.loc.Commune,zip:a.user.loc.NPA,canton:a.user.loc.Canton}).then(function(){c.go("main")})["catch"](function(b){b=b.data,a.errors={},angular.forEach(b.errors,function(b,c){d[c].$setValidity("mongoose",!1),a.errors[c]=b.message})}))},a.loginOauth=function(a){d.location.href="/auth/"+a},a.disabled=function(a,b){return"day"===b&&(0===a.getDay()||6===a.getDay())},a.maxDate=new Date,a.open=function(b){b.preventDefault(),b.stopPropagation(),a.opened=!0},a.dateOptions={formatYear:"yyyy",startingDay:1};var h=new Date;h.setDate(h.getDate()+1);var i=new Date;i.setDate(h.getDate()+2),a.events=[{date:h,status:"full"},{date:i,status:"partially"}],a.getDayClass=function(b,c){if("day"===c)for(var d=new Date(b).setHours(0,0,0,0),e=0;e<a.events.length;e++){var f=new Date(a.events[e].date).setHours(0,0,0,0);if(d===f)return a.events[e].status}return""}}]);var App=angular.module("tbApp");App.controller("StaffCtrl",["$scope","$state","$log","Staff",function(a,b,c,d){a.staff={},a.message="",a.register=function(e){c.debug(a.staff),e.$valid&&d.createStaff({name:a.staff.name,email:a.staff.email,mobile:a.staff.mobile,phone:a.staff.phone},function(a){b.go("main")},function(a){a=a.data})}}]),angular.module("tbApp").controller("BusinessFbPageCtrl",["$scope","ezfb","$q","$log","Auth","Business",function(a,b,c,d,e,f){function g(b){f.showBusiness(b.businessId,function(b){a.business=b},function(b){a.error=b})}function h(){b.getLoginStatus().then(function(){return b.api("/me")}).then(function(b){a.me=b,d.debug(a.me)})}function i(){return b.getLoginStatus().then(function(b){"connected"!==b.status?(d.debug("pas connecté"),a.isConnected=!1):(d.debug("connecté"),a.isConnected=!0),a.loginStatus=b})}function j(){return c.all([b.api("/me"),b.api("/me/likes")]).then(function(b){a.apiRes=b})}a.business={},a.message={},a.error={},a.isConnected=!1,e.getCurrentUser(function(a){return a}).then(g),b.Event.subscribe("auth.statusChange",function(b){a.loginStatus=b,h(),j()}),a.login=function(){b.login(function(){},{scope:"email,user_likes,manage_pages,publish_pages"}).then(function(b){"connected"!==b.status?(d.debug("pas connecté"),a.isConnected=!1):(d.debug("connecté"),a.isConnected=!0)})},a.logout=function(){b.logout()},a.sendPageId=function(b){var c={fbPageId:b};f.addPageId(a.business._id,c,function(b){a.business=b.business,a.message=b.message},function(b){a.error=b})},a.addApp=function(){b.ui({method:"pagetab",redirect_uri:"https://directhaircut.ch/fb/rendezvous"},function(a){d.debug(a)})},a.publishLink=function(c){var e={message:"test message",link:"https://directhaircut.ch/"+a.business._id};b.api("/"+c+"/feed","POST",e,function(a){d.debug(a)})};var k=["loginStatus","apiRes"];angular.forEach(k,function(b){a.$watch(b,function(c){a[b+"JSON"]=JSON.stringify(c,null,2)},!0)}),h(),i().then(j)}]),angular.module("tbApp").controller("BusinessPrestationsCtrl",["$scope","$log","Auth","Business",function(a,b,c,d){function e(b){d.getPrestations(b.businessId,function(b){a.prestations=b.prestations},function(b){a.error=b})}function f(b){var b=b;return a.alerts=[],(void 0===b.categoryName||""===b.categoryName)&&(b.categoryName="Prix sans nom",a.alerts.push({field:"Categorie",text:"Remplacé par une valeur par defaut : "+b.categoryName})),void 0===b.gender&&(b.gender="mixte",a.alerts.push({field:"Sexe",text:"Remplacé par une valeur par defaut : "+b.gender})),(void 0===b.ageLowLimit||b.ageLowLimit<=0)&&(b.ageLowLimit=1,a.alerts.push({field:"Age min",text:"Age minimum non valide, remplacé par : "+b.ageLowLimit})),(void 0===b.ageHighLimit||b.ageHighLimit>99)&&(b.ageHighLimit=99,a.alerts.push({field:"Age max",text:"Age maximum non valide, remplacé par : "+b.ageHighLimit})),(b.price<=0||b.price>999||void 0===b.price)&&(b.price=25,a.alerts.push({field:"Prix",text:"Remplacé par une valeur par defaut : "+b.price})),b}a.prestation={},a.formPrestation={},a.prestations={},a.user={},a.form={},a.formAdd={},a.addPriceForm=!1,a.editPriceForm=!1,a.addPrestationForm=!1,a.editPrestationForm=!1,a.durations=[{label:5},{label:10},{label:15},{label:20},{label:25},{label:30},{label:35},{label:40},{label:45},{label:50},{label:55},{label:60},{label:65},{label:70},{label:75},{label:80},{label:85},{label:90},{label:95},{label:100},{label:105},{label:110},{label:115},{label:120}],c.getCurrentUser(function(b){return a.user=b,b}).then(e),a.addPrestation=function(c){if(a.submitted=!0,c.$valid){var e={name:a.prestation.name,shortDescription:a.prestation.shortDescription,description:a.prestation.description,duration:a.prestation.duration.label};b.debug(e),d.createPrestation(a.user.businessId,e,function(b){a.prestations.push(b.prestation)},function(a){b.debug(a)}),a.addPrestationForm=!1}},a.deletePrestation=function(b,c){d.deletePrestation(a.user.businessId,b._id,function(b){a.prestations.splice(c,1),a.message=b.message},function(b){a.message=b})},a.editPrestationCopy=function(b){angular.copy(b,a.formPrestation);for(var c=a.durations.length-1;c>=0;c--)a.durations[c].label===a.formPrestation.duration&&(a.initialDuration=a.durations[c])},a.updatePrestation=function(c,e,f){b.debug(c);var g={name:c.name,description:c.description,duration:e.label};d.updatePrestation(a.user.businessId,c._id,g,function(b){a.prestations[f]=b.prestation},function(a){b.debug(a)})},a.cancelAddForm=function(){a.addPrestationForm=!1},a.editPriceCopy=function(b){angular.copy(b,a.form)},a.addPrice=function(b,c){var e=f(c);d.createPrice(a.user.businessId,b,e,function(b){a.message=b.message;for(var c=b.prestation._id,d=a.prestations.length-1;d>=0;d--)a.prestations[d]._id===c&&(a.prestations[d]=b.prestation);a.formAdd={},a.addPriceForm=!1},function(b){a.message=b})},a.updatePrice=function(c,e,g){var h=f(g);d.updatePrice(a.user.businessId,c,e,h,function(c){for(var d=a.prestations.length-1;d>=0;d--)a.prestations[d]._id===c.prestation._id&&(a.prestations[d]=c.prestation);b.debug(a.prestations)},function(a){b.debug(a)})},a.deletePrice=function(c,e,f,g){d.deletePrice(a.user.businessId,c,e,function(b){a.message=b.message,a.prestations[f].prices.splice(g,1)},function(a){b.debug(a)})},a.closeAlert=function(b){a.alerts.splice(b,1)}}]),angular.module("tbApp").controller("BusinessRendezvousCtrl",["$scope","$log","Auth","Business",function(a,b,c,d){function e(b){a.currentUser=b,d.getStaffs(b.businessId,function(b){a.staffs=b.staffs,a.defaultStaff=b.staffs[0]},function(b){a.error=b})}function f(a){var b=moment(a).add(1,"week")._d;return b}c.getCurrentUser(function(a){return a}).then(e),a.now=new Date,a.weeks=[];for(var g=moment(a.now).isoWeek(),h=moment().isoWeeksInYear(),i=[],j=0;h>j;j++)if(0===j){var k={startDay:moment("2015-01-01").startOf("isoWeek")._d,endDay:moment("2015-01-01").endOf("isoWeeks")._d,label:"semaine "+(j+1)};i.push(k)}else k={startDay:f(i[j-1].startDay),endDay:f(i[j-1].endDay),label:"semaine "+(j+1)},i.push(k);a.weeks=i,a.defaultWeek=a.weeks[g-1],a.search=function(c,e){var f={staffId:e._id,startDay:c.startDay,endDay:c.endDay};b.debug(f),d.searchRendezvous(a.currentUser.businessId,f,function(b){a.rendezvous=b.rendezvous,a.message=b.message},function(b){a.error=b})}}]),angular.module("tbApp").controller("BusinessSchedulesCtrl",["$scope","$log","Auth","Business",function(a,b,c,d){function e(c){d.getSchedules(c.businessId,function(b){a.schedules=b.horaires},function(a){b.debug=a}),d.getStaffs(c.businessId,function(b){a.staffs=b.staffs},function(a){b.debug=a})}function f(){for(var a=["00","15","30","45"],b=["06","07","08","09","10","11","12","13","14","15","16","17","18","19"],c=[],d=b.length;d>0;d--)for(var e=a.length;e>0;e--)c.push(String(b[b.length-d]+":"+a[a.length-e]));return c}function g(b){for(var c=0,d=a.options.length-1;d>=0;d--)a.options[d]===b&&(c=d);return c}a.schedules={},a.form={},a.user={},a.edit={},a.modif=!1,a.add=!1,c.getCurrentUser(function(b){return a.user=b,b}).then(e),a.options=f(),a.optionsDay=["lundi","mardi","mercredi","jeudi","vendredi","samedi","dimanche"],a.optionsWorkingDay=[{value:!0,label:"Oui"},{value:!1,label:"non"}],a.addSchedule=function(c){var e=!0;void 0===c.description&&(e=!1),""===c.startHour&&c.workingDay!==!1&&(e=!1),""===c.endHour&&c.workingDay!==!1&&(e=!1),""===c.dayName&&(e=!1),""===c.workingDay&&(e=!1);var f=g(c.startHour),h=g(c.endHour);b.debug(c.startHour<c.endHour),f>=h&&c.workingDay!==!1&&(e=!1),e?d.addSchedule(a.user.businessId,c,function(c){b.debug(c),a.schedules=c.horaires,a.form=null,a.add=!1,e=null},function(a){b.debug=a}):a.invalidForm="Formulaire invalide."},a.deleteSchedule=function(c){for(var e=a.schedules.length-1;e>=0;e--)a.schedules[e]._id===c&&a.schedules.splice(e,1);d.deleteSchedule(a.user.businessId,c,function(a){},function(a){b.debug=a})},a.editSchedule=function(b){angular.copy(b,a.edit)},a.updateSchedule=function(c,e){var f={dayName:c.dayName,description:c.description,startHour:c.startHour,endHour:c.endHour,workingDay:c.workingDay};d.updateSchedule(a.user.businessId,c._id,f,function(b){a.schedules[e]=b.horaire},function(a){b.debug(a)})}}]),angular.module("tbApp").controller("BusinessShowCtrl",["$scope","Auth","Business","Urls",function(a,b,c,d){function e(b){c.showBusiness(b.businessId,function(b){a.business=b,a.business.imageBusinessUrl=d.client+a.business.imageBusinessUrl},function(b){a.error=b})}b.getCurrentUser(function(a){return a}).then(e)}]),angular.module("tbApp").controller("BusinessStaffsCtrl",["$scope","$log","$http","Auth","Business","Urls",function(a,b,c,d,e,f){function g(a){for(var b=a.length-1;b>=0;b--){var c=h(a[b].createdOn);a[b].createdOn=c,"not processed"===a[b].status&&(a[b].status="non traitée"),"refused"===a[b].status&&(a[b].status="refusée"),"accepted"===a[b].status&&(a[b].status="acceptée")}return a}function h(a){var b=new Date(a);return b=b.getDate()+"/"+(b.getMonth()+1)+"/"+b.getFullYear()}function i(b){e.getStaffs(b.businessId,function(b){a.staffs=b.staffs;for(var c=a.staffs.length-1;c>=0;c--)a.staffs[c].photoStaffURL=f.img+a.staffs[c].photoStaffURL;return a.staffs},function(b){a.error=b}),e.getNotifications(b.businessId,function(b){return a.notifs=b.notifications,g(a.notifs),a.notifs},function(b){a.error=b}),a.businessId=b.businessId}a.edit=!1,d.getCurrentUser(function(a){return a}).then(i),c.get("/api/users").then(function(b){return a.users=b.data,a.users}),a.deleteNotification=function(b,c){e.deleteNotification(a.businessId,b,function(b){return a.notifs.splice(c,1),b})},a.createNotification=function(b){e.createNotification(a.businessId,{receptorId:b},function(b){var c=[];c.push(b.notification),c=g(c),a.form=null,a.notifs.push(c[0])},function(b){a.error=b})}}]),angular.module("tbApp").config(["$stateProvider",function(a){a.state("business-prestations",{url:"/business/prestations",templateUrl:"app/business/business-prestations/business-prestations.html",controller:"BusinessPrestationsCtrl",authenticate:!0}).state("business-prestationsNewPrice",{url:"/business/prestations/NewPrice",templateUrl:"app/business/business-prestations/business-prestations-newPrice.html",controller:"BusinessPrestationsCtrl",authenticate:!0}).state("business-rendezvous",{url:"/business/rendezvous",templateUrl:"app/business/business-rendezvous/business-rendezvous.html",controller:"BusinessRendezvousCtrl",authenticate:!0}).state("business-schedules",{url:"/business/schedules",templateUrl:"app/business/business-schedules/business-schedules.html",controller:"BusinessSchedulesCtrl",authenticate:!0}).state("business-show",{url:"/business/show",templateUrl:"app/business/business-show/business-show.html",controller:"BusinessShowCtrl",authenticate:!0}).state("business-staffs",{url:"/business/staffs",templateUrl:"app/business/business-staffs/business-staffs.html",controller:"BusinessStaffsCtrl",authenticate:!0}).state("business-fb-page",{url:"/business/fb-page",templateUrl:"app/business/business-fb-page/business-fb-page.html",controller:"BusinessFbPageCtrl",authenticate:!0})}]),angular.module("tbApp").controller("FbLoginCtrl",["$scope","$state","Auth",function(a,b,c){a.user={},a.errors={},a.login=function(d){a.submitted=!0,d.$valid&&c.login({email:a.user.email,password:a.user.password}).then(function(){b.go("fb.step1")})["catch"](function(b){a.errors.other=b.message})}}]);var App=angular.module("tbApp");App.controller("FbSignupCtrl",["$scope","$log","$state","$http","Urls","Auth",function(a,b,c,d,e,f){a.user={},a.errors={},a.localites={},d.get(e.api+"geodatas").then(function(b){return a.geodatas=b.data.geodatas,a.geodatas},function(b){a.error=b}),a.register=function(d){a.submitted=!0,b.debug(a.user),d.$valid&&(b.debug(d.$valid),f.createUser({firstName:a.user.firstName,lastName:a.user.lastName,email:a.user.email,password:a.user.password,dateOfBirth:a.user.dateOfBirth,gender:a.user.gender,city:a.user.loc.Commune,zip:a.user.loc.NPA,canton:a.user.loc.Canton}).then(function(){c.go("fb.step1")})["catch"](function(b){b=b.data,a.errors={},angular.forEach(b.errors,function(b,c){d[c].$setValidity("mongoose",!1),a.errors[c]=b.message})}))},a.disabled=function(a,b){return"day"===b&&(0===a.getDay()||6===a.getDay())},a.maxDate=new Date,a.open=function(b){b.preventDefault(),b.stopPropagation(),a.opened=!0},a.dateOptions={formatYear:"yyyy",startingDay:1};var g=new Date;g.setDate(g.getDate()+1);var h=new Date;h.setDate(g.getDate()+2),a.events=[{date:g,status:"full"},{date:h,status:"partially"}],a.getDayClass=function(b,c){if("day"===c)for(var d=new Date(b).setHours(0,0,0,0),e=0;e<a.events.length;e++){var f=new Date(a.events[e].date).setHours(0,0,0,0);if(d===f)return a.events[e].status}return""}}]),angular.module("tbApp").controller("FbCtrl",["$scope","$log","$http","$cookies","$state","Auth","Urls","Business","Rendezvous","AppStorage","CalendarService",function(a,b,c,d,e,f,g,h,i,j,k){function l(b){var c=a.currentWeek.firstDay,d=a.currentWeek.lastDay;return(0===b||void 0===b)&&(c=moment().startOf("isoWeek")._d,d=moment().endOf("isoWeek")._d),b>0&&(c=moment().add(b,"weeks").startOf("isoWeek")._d,d=moment().add(b,"weeks").endOf("isoWeek")._d),0>b&&(c=moment().subtract(1,"weeks").startOf("isoWeek")._d,d=moment().subtract(1,"weeks").endOf("isoWeek")._d),a.currentWeek.firstDay=c,a.currentWeek.lastDay=d,a.currentWeek}if(a.isLoggedIn=f.isLoggedIn,a.formData={},a.formData.user=f.getCurrentUser(),a.prestations={},a.schedules={},a.eventSources=[],a.events=[],a.myRendezvous=[],a.businessHours=[],a.currentWeek={},a.currentWeek.firstDay="",a.currentWeek.lastDay="",d.get("page-id")&&(j.setPageId(d.get("page-id")),d.remove("page-id")),b.debug("fb call from page id "+j.getPageId()),a.fb=function(){c.post(g.api+"fb/rendezvous",{signed_request:"9HOX6j2CfLglBxXI2wr11zTmix3VJWx8xI7C5sM_qyo.eyJhbGdvcml0aG0iOiJITUFDLVNIQTI1NiIsImV4cGlyZXMiOjE0Mzc0ODM2MDAsImlzc3VlZF9hdCI6MTQzNzQ3NzA5NSwib2F1dGhfdG9rZW4iOiJDQUFVWkE2U1hhcmVNQkFFd3FWRFpBQU1zc3hOUzlPWkFEeFkybDZPM0dTeW1uMndyUDlGa0h0WVF2dkVlMmZOajh0aXJRNDFKU1NaQnZGanJESVhLWHFzUmVHSGg1RXFaQWM2eTVuZ2t6ek5ZcDJFVXlTNW1TRTFYWkJiZFpCU0NOWkJiNmZxeWo2MzY5UkNHWkFSY1pDY3d3RnRYSGs0WDV6UFlkcUNDb3l5M1NQbVpDUDhvUTl1SlBLRkxlNEhpaWg2dzg5d3NRU0dmV0FHemNzeE9MZFNYb1d4IiwicGFnZSI6eyJpZCI6Ijg4NDk2MDQxODIyNTExNyIsImFkbWluIjp0cnVlfSwidXNlciI6eyJjb3VudHJ5IjoiY2giLCJsb2NhbGUiOiJmcl9GUiIsImFnZSI6eyJtaW4iOjIxfX0sInVzZXJfaWQiOiIxMDIwNzMyMDY1MTA0MDQ0MCJ9"}).success(function(){}).error(function(){})},j.getPageId()){var m={fbPageId:j.getPageId()};h.searchByPageId(m,function(c){a.formData.business=c,a.schedules=c.schedules,h.getPrestations(a.formData.business._id,function(b){a.prestations=b.prestations;for(var c=a.prestations.length-1;c>=0;c--)a.prestations[c].open=!1;return a.prestations},function(a){b.debug(a)})},function(a){b.debug(a)})}a.getPrice=function(c,d){a.formData.prestation=c;for(var e=c.prices,f=e.length-1;f>=0;f--)d.age<e[f].ageHighLimit&&d.age>e[f].ageLowLimit&&(d.gender===e[f].gender||"mixte"===e[f].gender)&&(a.formData.prestation.prices=e[f],a.$apply);return b.debug(a.formData),a.formData},a.getCalendar=function(b){void 0!==b.prestation?(h.getStaffs(a.formData.business._id,function(b){return a.staffs=b.staffs,a.staffs},function(b){a.error=b}),e.go("fb.step2")):a.errorPrestation=!0},a.selected=function(c,d){a.staffWasSelected=!0,a.selectedIndex=c,a.selectedStaff=d._id,a.formData.staff=d,l(0);var e={staffId:d._id,startDay:a.currentWeek.firstDay,endDay:a.currentWeek.lastDay};h.searchRendezvous(a.formData.business._id,e,function(c){var d=c.rendezvous;a.events=k.createRendezvousTakenEvents(a.events,d),a.businessHours=k.createBusinessHoursEvents(a.businessHours,a.schedules,a.currentWeek.firstDay),a.myRendezvous=k.createMyRendezvousEvent(a.myRendezvous,new Date,a.formData.prestation),b.debug(a.events),b.debug(a.businessHours),b.debug(a.myRendezvous)},function(b){a.error=b})};var n="7:00:00";a.uiConfig={calendar:{height:550,editable:!0,lang:"fr",header:{left:"title",center:"",right:"today prev,next"},defaultView:"agendaWeek",firstDay:1,timezone:"local",timeFormat:"h:mm",allDaySlot:!1,slotDuration:"00:10:00",scrollTime:n,eventStartEditable:!0,eventDurationEditable:!1,eventClick:function(a,c,d){b.debug("clicked")},eventDrop:function(b,c,d,e,f,g){a.myRendezvous[0].start=b._start._d,a.myRendezvous[0].end=b._end._d},viewRender:function(c,d){if(a.staffWasSelected){var e=moment(c.start._d).subtract(2,"hours")._d,f=moment(c.end._d).subtract(2,"hours")._d,g={staffId:a.selectedStaff,startDay:e,endDay:f};h.searchRendezvous(a.formData.business._id,g,function(c){var d=c.rendezvous;a.events=k.createRendezvousTakenEvents(a.events,d),a.businessHours=k.createBusinessHoursEvents(a.businessHours,a.schedules,e),a.myRendezvous=k.createMyRendezvousEvent(a.myRendezvous,e,a.formData.prestation),b.debug(a.events),b.debug(a.businessHours),b.debug(a.myRendezvous)},function(b){a.error=b})}else b.debug("rien à afficher.")}}},a.eventSources=[a.events,a.myRendezvous,a.businessHours],a.getConfirm=function(c){a.formData.myRendezvous=c,b.debug(a.formData),e.go("fb.step3")},a.bookRendezvous=function(a){b.debug(a);var c={businessId:a.business._id,prestationId:a.prestation._id,staffId:a.staff._id,staffName:a.staff.name,startHour:a.myRendezvous[0].start,endHour:a.myRendezvous[0].end};i.createRendezvous(c,function(a){b.debug(a)},function(a){b.debug(a)}),e.go("fb-rendezvous")},a.cancelRendezvous=function(){e.go("fb-rendezvous")}}]),angular.module("tbApp").config(["$stateProvider",function(a){a.state("fb-login",{url:"/fb/login",templateUrl:"app/fb/account/login.html",controller:"FbLoginCtrl"}).state("fb-signup",{url:"/fb/signup",templateUrl:"app/fb/account/signup.html",controller:"FbSignupCtrl"}).state("fb-rendezvous",{url:"/fb/rendezvous",templateUrl:"app/fb/account/rdv.html",controller:"MyRendezvousCtrl"}).state("fb",{url:"/pagetab",templateUrl:"app/fb/fb.html",controller:"FbCtrl"}).state("fb.step1",{url:"/step1",templateUrl:"app/rendezvous/rendezvous-step2.html"}).state("fb.step2",{url:"/step2",templateUrl:"app/rendezvous/rendezvous-step3.html"}).state("fb.step3",{url:"/step3",templateUrl:"app/rendezvous/rendezvous-step4.html"})}]),angular.module("tbApp").controller("BusinessProfileCtrl",["$scope","Business","$stateParams",function(a,b,c){b.showBusiness(c.id,function(b){a.business=b},function(b){a.error=b})}]),angular.module("tbApp").controller("MainCtrl",["$scope","$http","$log","$state","$cookies","Urls","Auth","Business",function(a,b,c,d,e,f,g,h){function i(){e.get("page-id")?d.go("fb.step1"):(b.get("/api/businesses").success(function(b){a.businesses=b}),g.getCurrentUser(function(a){return a}).then(j))}function j(b){a.currentUser=b,void 0!==a.currentUser.preferences.favorite&&(c.debug(a.currentUser.preferences.favorite),h.showBusiness(a.currentUser.preferences.favorite,function(b){a.favoriteBusiness=b},function(b){a.error=b}))}a.businesses=[],a.isLoggedIn=g.isLoggedIn,i(),a.selectedIndex=-1,a.itemClicked=function(b){a.selectedIndex=b},a.fav=function(c){b.put(f.api+"users/"+a.currentUser._id+"/prefFavorite",{businessId:c},function(a){return a},function(a){return a})}}]),angular.module("tbApp").config(["$stateProvider",function(a){a.state("main",{url:"/",templateUrl:"app/main/main.html",controller:"MainCtrl"}).state("businessProfile",{url:"/business/:id",templateUrl:"app/business/business-show/business-show.html",controller:"BusinessProfileCtrl"})}]),angular.module("tbApp").controller("RendezvousUserCtrl",["$scope","$http","$state","$stateParams","$log","Auth","User","Business","Rendezvous","localStorageService","uiCalendarConfig","CalendarService",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(b){var c=a.currentWeek.firstDay,d=a.currentWeek.lastDay;return(0===b||void 0===b)&&(c=moment().startOf("isoWeek")._d,d=moment().endOf("isoWeek")._d),a.currentWeek.firstDay=c,a.currentWeek.lastDay=d,a.currentWeek}a.isStaff=f.isStaff,a.selectedIndex=-1,a.staffWasSelected=!1,a.formData={},a.formData.user=f.getCurrentUser(),a.prestations={},a.schedules={},a.eventSources=[],a.events=[],a.myRendezvous=[],a.businessHours=[],a.currentWeek={},a.currentWeek.firstDay="",a.currentWeek.lastDay="",b.get("/api/businesses/"+d.id).then(function(b){return a.formData.business=b.data,a.schedules=b.data.schedules,a.formData}).then(function(b){h.getPrestations(a.formData.business._id,function(b){a.prestations=b.prestations;for(var c=a.prestations.length-1;c>=0;c--)a.prestations[c].open=!1;return a.prestations},function(a){e.debug(a)})}),a.getPrice=function(b,c){a.formData.prestation=b;for(var d=b.prices,f=d.length-1;f>=0;f--)c.age<d[f].ageHighLimit&&c.age>d[f].ageLowLimit&&(c.gender===d[f].gender||"mixte"===d[f].gender)&&(a.formData.prestation.prices=d[f],a.$apply);return e.debug(a.formData),a.formData},a.getCalendar=function(b){void 0!==b.prestation?(h.getStaffs(a.formData.business._id,function(b){return a.staffs=b.staffs,a.staffs},function(b){a.error=b}),c.go("rendezvousUser.step2")):a.errorPrestation=!0},a.selected=function(b,c){a.staffWasSelected=!0,a.selectedIndex=b,a.selectedStaff=c._id,a.formData.staff=c,m(0);var d={staffId:c._id,startDay:a.currentWeek.firstDay,endDay:a.currentWeek.lastDay};h.searchRendezvous(a.formData.business._id,d,function(b){var c=b.rendezvous;a.events=l.createRendezvousTakenEvents(a.events,c),a.businessHours=l.createBusinessHoursEvents(a.businessHours,a.schedules,a.currentWeek.firstDay),a.myRendezvous=l.createMyRendezvousEvent(a.myRendezvous,new Date,a.formData.prestation),e.debug(a.events),e.debug(a.businessHours),e.debug(a.myRendezvous)},function(b){a.error=b})};var n="7:00:00";a.uiConfig={calendar:{height:550,editable:!0,lang:"fr",header:{left:"title",center:"",right:"today prev,next"},defaultView:"agendaWeek",firstDay:1,timezone:"local",timeFormat:"h:mm",allDaySlot:!1,slotDuration:"00:10:00",scrollTime:n,eventStartEditable:!0,eventDurationEditable:!1,eventClick:function(a,b,c){e.debug("clicked")},eventDrop:function(b,c,d,e,f,g){a.myRendezvous[0].start=b._start._d,a.myRendezvous[0].end=b._end._d},viewRender:function(b,c){if(a.staffWasSelected){var d=moment(b.start._d).subtract(2,"hours")._d,f=moment(b.end._d).subtract(2,"hours")._d,g={staffId:a.selectedStaff,startDay:d,endDay:f};h.searchRendezvous(a.formData.business._id,g,function(b){var c=b.rendezvous;a.events=l.createRendezvousTakenEvents(a.events,c),a.businessHours=l.createBusinessHoursEvents(a.businessHours,a.schedules,d),a.myRendezvous=l.createMyRendezvousEvent(a.myRendezvous,d,a.formData.prestation),e.debug(a.events),e.debug(a.businessHours),e.debug(a.myRendezvous)},function(b){a.error=b})}else e.debug("rien à afficher.")}}},a.eventSources=[a.events,a.myRendezvous,a.businessHours],a.getConfirm=function(b){a.formData.myRendezvous=b,e.debug(a.formData),c.go("rendezvousUser.step3")},a.bookRendezvous=function(a){e.debug(a);var b={businessId:a.business._id,prestationId:a.prestation._id,staffId:a.staff._id,staffName:a.staff.name,startHour:a.myRendezvous[0].start,endHour:a.myRendezvous[0].end};i.createRendezvous(b,function(a){e.debug(a)},function(a){e.debug(a)}),c.go("main")},a.cancelRendezvous=function(){c.go("main")}}]),angular.module("tbApp").controller("RendezvousCtrl",["$scope","$http","$state","$log","Auth","User","Business","uiCalendarConfig","CalendarService",function(a,b,c,d,e,f,g,h,i){function j(b){var c=a.currentWeek.firstDay,d=a.currentWeek.lastDay;return(0===b||void 0===b)&&(c=moment().startOf("isoWeek")._d,d=moment().endOf("isoWeek")._d),a.currentWeek.firstDay=c,a.currentWeek.lastDay=d,a.currentWeek}a.isStaff=e.isStaff,a.selectedIndex=-1,a.staffWasSelected=!1,a.formData={},a.prestations={},a.schedules={},a.eventSources=[],a.events=[],a.myRendezvous=[],a.businessHours=[],a.currentWeek={},a.currentWeek.firstDay="",a.currentWeek.lastDay="",e.getCurrentUser(function(c){b.get("/api/businesses/"+c.businessId).then(function(b){return a.formData.business=b.data,a.schedules=b.data.schedules,a.formData})}),b.get("/api/users").then(function(b){return a.users=b.data,a.users}),a.getPrestations=function(b){void 0!==b.user?(g.getPrestations(b.business._id,function(b){a.prestations=b.prestations;for(var c=a.prestations.length-1;c>=0;c--)a.prestations[c].open=!1;return a.prestations},function(b){a.error=b}),c.go("rendezvous.step2")):a.errorUser=!0},a.getPrice=function(b,c){a.formData.prestation=b;for(var e=b.prices,f=e.length-1;f>=0;f--)c.age<e[f].ageHighLimit&&c.age>e[f].ageLowLimit&&(c.gender===e[f].gender||"mixte"===e[f].gender)&&(a.formData.prestation.prices=e[f],a.$apply);return d.debug(a.formData),a.formData},a.getCalendar=function(b){void 0!==b.prestation?(g.getStaffs(a.formData.business._id,function(b){return a.staffs=b.staffs,a.staffs},function(b){a.error=b}),c.go("rendezvous.step3")):a.errorPrestation=!0},a.selected=function(b,c){a.staffWasSelected=!0,a.selectedIndex=b,a.selectedStaff=c._id,a.formData.staff=c,j(0);var e={staffId:c._id,startDay:a.currentWeek.firstDay,endDay:a.currentWeek.lastDay};g.searchRendezvous(a.formData.business._id,e,function(b){var c=b.rendezvous;a.events=i.createRendezvousTakenEvents(a.events,c),a.businessHours=i.createBusinessHoursEvents(a.businessHours,a.schedules,a.currentWeek.firstDay),a.myRendezvous=i.createMyRendezvousEvent(a.myRendezvous,new Date,a.formData.prestation),d.debug(a.events),d.debug(a.businessHours),d.debug(a.myRendezvous)},function(b){a.error=b})};var k="7:00:00";a.uiConfig={calendar:{height:550,editable:!0,lang:"fr",header:{left:"title",center:"",right:"today prev,next"},defaultView:"agendaWeek",firstDay:1,timezone:"local",timeFormat:"h:mm",allDaySlot:!1,slotDuration:"00:10:00",scrollTime:k,eventStartEditable:!0,
eventDurationEditable:!1,eventClick:function(a,b,c){d.debug("clicked")},eventDrop:function(b,c,d,e,f,g){a.myRendezvous[0].start=b._start._d,a.myRendezvous[0].end=b._end._d},viewRender:function(b,c){if(a.staffWasSelected){var e=moment(b.start._d).subtract(2,"hours")._d,f=moment(b.end._d).subtract(2,"hours")._d,h={staffId:a.selectedStaff,startDay:e,endDay:f};g.searchRendezvous(a.formData.business._id,h,function(b){var c=b.rendezvous;a.events=i.createRendezvousTakenEvents(a.events,c),a.businessHours=i.createBusinessHoursEvents(a.businessHours,a.schedules,e),a.myRendezvous=i.createMyRendezvousEvent(a.myRendezvous,e,a.formData.prestation),d.debug(a.events),d.debug(a.businessHours),d.debug(a.myRendezvous)},function(b){a.error=b})}else d.debug("rien à afficher.")}}},a.eventSources=[a.events,a.myRendezvous,a.businessHours],a.getConfirm=function(b){a.formData.myRendezvous=b,d.debug(a.formData),c.go("rendezvous.step4")},a.bookRendezvous=function(a){d.debug(a);var b={clientId:a.user._id,prestationId:a.prestation._id,staffId:a.staff._id,staffName:a.staff.name,startHour:a.myRendezvous[0].start,endHour:a.myRendezvous[0].end};g.createRendezvous(a.business._id,b,function(a){d.debug(a)},function(a){d.debug(a)}),c.go("main")},a.cancelRendezvous=function(){c.go("main")}}]),angular.module("tbApp").config(["$stateProvider",function(a){a.state("rendezvous",{url:"/business/rendezvous",templateUrl:"app/rendezvous/rendezvous.html",controller:"RendezvousCtrl",authenticate:!0}).state("rendezvous.step1",{url:"/step1",templateUrl:"app/rendezvous/rendezvous-step1.html",authenticate:!0}).state("rendezvous.step2",{url:"/step2",templateUrl:"app/rendezvous/rendezvous-step2.html",authenticate:!0}).state("rendezvous.step3",{url:"/step3",templateUrl:"app/rendezvous/rendezvous-step3.html",authenticate:!0}).state("rendezvous.step4",{url:"/step4",templateUrl:"app/rendezvous/rendezvous-step4.html",authenticate:!0}).state("rendezvousUser",{url:"/business/:id/rendezvous",templateUrl:"app/rendezvous/rendezvous-user.html",controller:"RendezvousUserCtrl",authenticate:!0}).state("rendezvousUser.step1",{url:"/step1",templateUrl:"app/rendezvous/rendezvous-step2.html",authenticate:!0}).state("rendezvousUser.step2",{url:"/step2",templateUrl:"app/rendezvous/rendezvous-step3.html",authenticate:!0}).state("rendezvousUser.step3",{url:"/step3",templateUrl:"app/rendezvous/rendezvous-step4.html",authenticate:!0})}]),angular.module("tbApp").factory("Auth",["$http","User","$cookieStore","$q",function(a,b,c,d){var e=function(a){return angular.isFunction(a)?a:angular.noop},f={};return c.get("token")&&(f=b.get()),{login:function(g,h){return a.post("/auth/local",{email:g.email,password:g.password}).then(function(a){return c.put("token",a.data.token),f=b.get(),e(h)(),a.data},function(a){return this.logout(),e(h)(a.data),d.reject(a.data)}.bind(this))},logout:function(){c.remove("token"),f={}},createUser:function(a,d){return b.save(a,function(g){return c.put("token",g.token),f=b.get(),e(d)(null,a)},function(a){return this.logout(),e(d)(a)}.bind(this)).$promise},createManager:function(a,d){return b.createManager(a,function(g){return c.put("token",g.token),f=b.get(),e(d)(null,a)},function(a){return this.logout(),e(d)(a)}.bind(this)).$promise},changePassword:function(a,c,d){return b.changePassword({id:f._id},{oldPassword:a,newPassword:c},function(a){return e(d)(null,a)},function(a){return e(d)(a)}).$promise},getCurrentUser:function(a){if(0===arguments.length)return f;var b=f.hasOwnProperty("$promise")?f.$promise:f;return d.when(b).then(function(b){return e(a)(b),b},function(){return e(a)({}),{}})},isLoggedIn:function(a){return 0===arguments.length?f.hasOwnProperty("roles"):this.getCurrentUser(null).then(function(b){var c=b.hasOwnProperty("roles");return e(a)(c),c})},isStaff:function(a){if(0===arguments.length){if(void 0===f.roles)return!1;var b=f.roles.indexOf("staff");return-1===b&&(b=!1),b}return this.getCurrentUser(null).then(function(b){if(void 0===b.roles)return!1;var c=b.roles.indexOf("staff");return e(a)(c),-1===c&&(c=!1),c})},isManager:function(a){if(0===arguments.length){if(void 0===f.roles)return!1;var b=f.roles.indexOf("manager");return-1===b&&(b=!1),b}return this.getCurrentUser(null).then(function(b){if(void 0===b.roles)return!1;var c=b.roles.indexOf("manager");return e(a)(c),-1===c&&(c=!1),c})},isBusinessCreated:function(){if(void 0===f.roles)return!1;var a=f.roles.indexOf("manager");if(-1===a)return!1;if(a){var b=f.businessId;return void 0===b?!0:!1}return!1},isStaffCreated:function(){if(void 0===f.roles)return!1;var a=f.roles.indexOf("staff");if(-1===a)return!1;if(a){var b=f.staffId;return void 0===b?!0:!1}return!1},getToken:function(){return c.get("token")}}}]),angular.module("tbApp").factory("Modal",["$rootScope","$modal",function(a,b){function c(c,d){var e=a.$new();return c=c||{},d=d||"modal-default",angular.extend(e,c),b.open({templateUrl:"components/modal/modal.html",windowClass:d,scope:e})}return{confirm:{"delete":function(a){return a=a||angular.noop,function(){var b,d=Array.prototype.slice.call(arguments),e=d.shift();b=c({modal:{dismissable:!0,title:"Confirm Delete",html:"<p>Are you sure you want to delete <strong>"+e+"</strong> ?</p>",buttons:[{classes:"btn-danger",text:"Delete",click:function(a){b.close(a)}},{classes:"btn-default",text:"Cancel",click:function(a){b.dismiss(a)}}]}},"modal-danger"),b.result.then(function(b){a.apply(b,d)})}}}}}]),angular.module("tbApp").directive("mongooseError",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){b.on("keydown",function(){return d.$setValidity("mongoose",!0)})}}});var app=angular.module("tbApp");app.controller("NavbarCtrl",["$scope","$location","Auth",function(a,b,c){a.isCollapsed=!0,a.isLoggedIn=c.isLoggedIn,a.isStaff=c.isStaff,a.isBusinessCreated=c.isBusinessCreated,a.isStaffCreated=c.isStaffCreated,a.getCurrentUser=c.getCurrentUser(),a.menu=[{title:"Home",link:"/"}],a.logout=function(){c.logout(),b.path("/")},a.isActive=function(a){return a===b.path()}}]),angular.module("tbApp").factory("AppStorage",function(){var a="";return{getPageId:function(){return a},setPageId:function(b){a=b},deletePageId:function(){a=void 0}}}),angular.module("tbApp").service("Business",["$http","Urls",function(a,b){return{getBusinesses:function(c,d){a({method:"GET",url:b.api+"businesses/"}).success(function(a){c(a)}).error(function(a){d(a)})},createBusiness:function(c,d,e){a({method:"POST",url:b.api+"businesses/",data:c}).success(function(a){d(a)}).error(function(a){e(a)})},showBusiness:function(c,d,e){a({method:"GET",url:b.api+"businesses/"+c}).success(function(a){d(a)}).error(function(a){e(a)})},updateBusiness:function(c,d,e,f){a({method:"PUT",url:b.api+"businesses/"+c,data:d}).success(function(a){e(a)}).error(function(a){f(a)})},addPageId:function(c,d,e,f){a({method:"PUT",url:b.api+"businesses/"+c+"/pageId",data:d}).success(function(a){e(a)}).error(function(a){f(a)})},searchByPageId:function(c,d,e){a({method:"POST",url:b.api+"businesses/searchByPageId",data:c}).success(function(a){d(a)}).error(function(a){e(a)})},getSchedules:function(c,d,e){a({method:"GET",url:b.api+"businesses/"+c+"/schedules"}).success(function(a){d(a)}).error(function(a){e(a)})},addSchedule:function(c,d,e,f){a({method:"POST",url:b.api+"businesses/"+c+"/schedules",data:d}).success(function(a){e(a)}).error(function(a){f(a)})},showSchedule:function(c,d,e,f){a({method:"GET",url:b.api+"businesses/"+c+"/schedules/"+d}).success(function(a){e(a)}).error(function(a){f(a)})},updateSchedule:function(c,d,e,f,g){a({method:"PUT",url:b.api+"businesses/"+c+"/schedules/"+d,data:e}).success(function(a){f(a)}).error(function(a){g(a)})},deleteSchedule:function(c,d,e,f){a({method:"DELETE",url:b.api+"businesses/"+c+"/schedules/"+d}).success(function(a){e(a)}).error(function(a){f(a)})},getStaffs:function(c,d,e){a({method:"GET",url:b.api+"businesses/"+c+"/staffs"}).success(function(a){d(a)}).error(function(a){e(a)})},showStaff:function(c,d,e,f){a({method:"GET",url:b.api+"businesses/"+c+"/staffs/"+d}).success(function(a){e(a)}).error(function(a){f(a)})},getPrestations:function(c,d,e){a({method:"GET",url:b.api+"businesses/"+c+"/prestations"}).success(function(a){d(a)}).error(function(a){e(a)})},createPrestation:function(c,d,e,f){a({method:"POST",url:b.api+"businesses/"+c+"/prestations",data:d}).success(function(a){e(a)}).error(function(a){f(a)})},showPrestation:function(c,d,e,f){a({method:"GET",url:b.api+"businesses/"+c+"/prestations/"+d}).success(function(a){e(a)}).error(function(a){f(a)})},updatePrestation:function(c,d,e,f,g){a({method:"PUT",url:b.api+"businesses/"+c+"/prestations/"+d,data:e}).success(function(a){f(a)}).error(function(a){g(a)})},deletePrestation:function(c,d,e,f){a({method:"DELETE",url:b.api+"businesses/"+c+"/prestations/"+d}).success(function(a){e(a)}).error(function(a){f(a)})},createPrice:function(c,d,e,f,g){a({method:"POST",url:b.api+"businesses/"+c+"/prestations/"+d+"/prices",data:e}).success(function(a){f(a)}).error(function(a){g(a)})},showPrice:function(c,d,e,f,g){a({method:"GET",url:b.api+"businesses/"+c+"/prestations/"+d+"/prices/"+e}).success(function(a){f(a)}).error(function(a){g(a)})},updatePrice:function(c,d,e,f,g,h){a({method:"PUT",url:b.api+"businesses/"+c+"/prestations/"+d+"/prices/"+e,data:f}).success(function(a){g(a)}).error(function(a){h(a)})},deletePrice:function(c,d,e,f,g){a({method:"DELETE",url:b.api+"businesses/"+c+"/prestations/"+d+"/prices/"+e}).success(function(a){f(a)}).error(function(a){g(a)})},getRendezvous:function(c,d,e){a({method:"GET",url:b.api+"businesses/"+c+"/rendezvous"}).success(function(a){d(a)}).error(function(a){e(a)})},searchRendezvous:function(c,d,e,f){a({method:"POST",url:b.api+"businesses/"+c+"/rendezvous/search",data:d}).success(function(a){e(a)}).error(function(a){f(a)})},createRendezvous:function(c,d,e,f){a({method:"POST",url:b.api+"businesses/"+c+"/rendezvous",data:d}).success(function(a){e(a)}).error(function(a){f(a)})},showRendezvous:function(c,d,e,f){a({method:"GET",url:b.api+"businesses/"+c+"/rendezvous/"+d}).success(function(a){e(a)}).error(function(a){f(a)})},getNotifications:function(c,d,e){a({method:"GET",url:b.api+"businesses/"+c+"/notifications"}).success(function(a){d(a)}).error(function(a){e(a)})},createNotification:function(c,d,e,f){a({method:"POST",url:b.api+"businesses/"+c+"/notifications",data:d}).success(function(a){e(a)}).error(function(a){f(a)})},deleteNotification:function(c,d,e,f){a({method:"DELETE",url:b.api+"businesses/"+c+"/notifications/"+d}).success(function(a){e(a)}).error(function(a){f(a)})}}}]),angular.module("tbApp").factory("CalendarService",["$log",function(a){function b(a){var b=moment(a).format("YYYY[-]MM[-]DD[T]HH[:]mm[:]ss");return b}function c(a){var b=String(a);return b=b.substring(0,2),"0"===b.charAt(0)&&(b=b.substring(1)),b=Number(b)}return{createRendezvousTakenEvents:function(a,c){var d=a;d.splice(0,d.length);for(var e=c,f=[],g="",h="",i=e.length-1;i>=0;i--)g=e[i].startHour,g=b(g),h=e[i].endHour,h=b(h),f={id:"blocked",start:g,end:h,overlap:!1,rendering:"background",color:"red"},d.push(f);return d},createBusinessHoursEvents:function(a,d,e){var f=a,g=d;f.splice(0,f.length);for(var h=e,i={},j="",k="",l=0;l<=g.length-1;l++)if(g[l].workingDay===!0){if(0===l){var m=0,n=c(g[l].startHour);j=h,k=moment(h).add(n,"hours")._d,j=b(j),k=b(k),i={id:"closed",start:j,end:k,overlap:!1,rendering:"background",color:"grey"},f.push(i);var o=moment(h).add(1,"days")._d;m=c(g[l].endHour),n=c(g[l+1].startHour),j=moment(h).add(m,"hours")._d,k=moment(o).add(n,"hours")._d,j=b(j),k=b(k),i={id:"closed",start:j,end:k,overlap:!1,rendering:"background",color:"grey"},f.push(i)}else h=moment(h).add(1,"days")._d,o=moment(h).add(1,"days")._d,m=c(g[l].endHour),n=c(g[l+1].startHour),j=moment(h).add(m,"hours")._d,k=moment(o).add(n,"hours")._d,j=b(j),k=b(k),i={id:"closed",start:j,end:k,overlap:!1,rendering:"background",color:"grey"},f.push(i);l===g.length-1&&(m=c(g[l].endHour),n=0,j=moment(h).add(n,"hours")._d,k=moment(h).endOf("day")._d,j=b(j),k=b(k),i={id:"closed",start:j,end:k,overlap:!1,rendering:"background",color:"grey"},f.push(i))}else h=moment(h).add(1,"days")._d,j=h,k=moment(h).endOf("day")._d,j=b(j),k=b(k),i={id:"closed",start:j,end:k,overlap:!1,rendering:"background",color:"grey"},f.push(i);return f},createMyRendezvousEvent:function(a,b,c){var d=a;d.length>0&&d.splice(0,1);for(var b=b,e=b.getDate(),f=b.getMonth(),g=b.getFullYear(),h=c.duration,i=8,j=8,k="",l=h;l>=0;l-=60)l>=60&&j++,60>l&&(k=l);var m={id:"myRdv",title:"Votre rendez-vous",start:new Date(g,f,e,i,0),end:new Date(g,f,e,j,k),color:"green"};return d.push(m),d}}}]),angular.module("tbApp").service("Notification",["$http","Urls",function(a,b){return{getNotificiations:function(c,d){a({method:"GET",url:b.api+"notifications/"}).success(function(a){c=a}).error(function(a){d=a})},acceptNotification:function(c,d,e){a({method:"PUT",url:b.api+"notifications/"+c+"/accepted"}).success(function(a){d(a)}).error(function(a){e(a)})},refuseNotification:function(c,d,e){a({method:"PUT",url:b.api+"notifications/"+c+"/refused"}).success(function(a){d(a)}).error(function(a){e(a)})},deleteNotification:function(c,d,e){a({method:"DELETE",url:b.api+"notifications/"+c}).success(function(a){d(a)}).error(function(a){e(a)})}}}]),angular.module("tbApp").service("Rendezvous",["$http","Urls",function(a,b){return{getRendezvous:function(c,d){a({method:"GET",url:b.api+"rendezvous/"}).success(function(a){c=a}).error(function(a){d=a})},createRendezvous:function(c,d,e){a({method:"POST",url:b.api+"rendezvous/",data:c}).success(function(a){d=a}).error(function(a){e=a})}}}]),angular.module("tbApp").service("Staff",["$http","Urls",function(a,b){return{createStaff:function(c,d,e){a({method:"POST",url:b.api+"staffs/",data:c}).success(function(a){d(a)}).error(function(a){e(a)})},getRendezvous:function(c,d,e){a({method:"GET",url:b.api+"staffs/"+c+"/rendezvous"}).success(function(a){d(a)}).error(function(a){e(a)})}}}]),angular.module("tbApp").factory("User",["$resource",function(a){return a("/api/users/:id/:controller",{id:"@_id"},{changePassword:{method:"PUT",params:{controller:"password"}},get:{method:"GET",params:{id:"me"}},createManager:{method:"POST",params:{id:"manager"}}})}]),angular.module("tbApp").run(["$templateCache",function(a){a.put("app/account/business/business.html",'<div ng-include="\'components/navbar/navbar.html\'"></div>\r\n\r\n<div class="container">\r\n  <div class="row">\r\n    \r\n    <div class="col-sm-8">\r\n      <h2>Creation du salon</h2>\r\n    </div>\r\n\r\n\r\n	  <form class="form" name="form" ng-submit="register(form)" novalidate>\r\n\r\n	  	<!-- name -->\r\n	    <div class="row">\r\n	      <div class="col-sm-4 col-sm-offset-3">\r\n	        <div class="form-group" ng-class="{ \'has-success\': form.name.$valid && submitted,\r\n	                                            \'has-error\': form.name.$invalid && submitted }">\r\n	          <label>Nom du salon <i class="fa fa-asterisk"></i></label>\r\n\r\n	          <input type="text" name="name" class="form-control" ng-model="business.name"\r\n	                 required/>\r\n	          <p class="help-block" ng-show="form.name.$error.required && submitted">\r\n	            Un nom de salon est requis.\r\n	          </p>\r\n	        </div>\r\n	      </div>\r\n	    </div>\r\n\r\n\r\n\r\n	    <hr>\r\n	    <h4>Localisation</h4>\r\n\r\n        <!-- localite custom template -->\r\n        <script type="text/ng-template" id="localiteTemplate.html">\r\n          <a>\r\n            <span bind-html-unsafe="match.model.Commune | typeaheadHighlight:query"></span>\r\n            (<span bind-html-unsafe="match.model.NPA | typeaheadHighlight:query"></span>)\r\n          </a>\r\n        </script>\r\n\r\n	    <!-- localité, npa, canton -->\r\n	    <div class="row">\r\n	      <div class="col-sm-4 col-sm-offset-3"><label>Localité <i class="fa fa-asterisk"></i></label>\r\n	        <input type="text" ng-model="business.loc" ng-bind="business.loc.Commune" typeahead-min-length="3" typehead-on-select(model) typeahead-editable="false" typeahead="geodata as geodata.Commune for geodata in geodatas | filter:$viewValue" class="form-control" typeahead-template-url="localiteTemplate.html">\r\n	      </div>\r\n	      <div class="col-sm-2"><label>NPA <i class="fa fa-asterisk"></i></label>\r\n	        <input type="text" ng-model="business.loc" ng-bind="business.loc.NPA" typeahead-min-length="2" typehead-on-select(model) typeahead-editable="false" typeahead="geodata as geodata.NPA for geodata in geodatas | filter:$viewValue | limitTo:8" class="form-control" disabled>\r\n	      </div>\r\n	      <div class="col-sm-2"><label>Canton <i class="fa fa-asterisk"></i></label>\r\n	        <input type="text" ng-model="business.loc" ng-bind="business.loc.Canton" typehead-on-select(model) typeahead-editable="false" typeahead="geodata as geodata.Canton for geodata in geodatas | filter:$viewValue | limitTo:8" class="form-control" disabled>\r\n	      </div>\r\n	    </div>\r\n\r\n	    <!-- adresse -->\r\n	    <div class="row">\r\n	      <div class="col-sm-4 col-sm-offset-3">\r\n	        <div class="form-group" ng-class="{ \'has-success\': form.street.$valid && submitted,\'has-error\': form.street.$invalid && submitted }">\r\n	          <label>Adresse et numéro de rue <i class="fa fa-asterisk"></i></label>\r\n\r\n	          <input type="text" name="street" class="form-control" ng-model="business.street" required/>\r\n	          <p class="help-block" ng-show="form.street.$error.required && submitted">\r\n	            Une adresse est requise.\r\n	          </p>\r\n	        </div>\r\n	      </div>\r\n	    </div>\r\n\r\n\r\n\r\n	    <hr>\r\n	    <h4>Contact</h4>\r\n\r\n	    <div class="row">\r\n\r\n	      <!-- email -->\r\n	      <div class="col-sm-4 col-sm-offset-3">\r\n	        <div class="form-group" ng-class="{ \'has-success\': form.email.$valid && submitted,\r\n	                                            \'has-error\': form.email.$invalid && submitted }">\r\n	          <label>Email</label>\r\n\r\n	          <input type="email" name="email" class="form-control" ng-model="business.email"\r\n	                 mongoose-error/>\r\n	          <p class="help-block" ng-show="form.email.$error.email && submitted">\r\n	            Ce n\'est pas une adresse mail valide.\r\n	          </p>\r\n	          <p class="help-block" ng-show="form.email.$error.mongoose">\r\n	            {{ errors.email }}\r\n	          </p>\r\n	        </div>\r\n	      </div>\r\n\r\n	      <!-- mobile -->\r\n	      <div class="col-sm-2">\r\n	        <div class="form-group" ng-class="{ \'has-success\': form.mobile.$valid && submitted,\r\n	                                            \'has-error\': form.mobile.$invalid && submitted }">\r\n	          \r\n	          <label>Mobile</label>\r\n	          <input type="tel" name="mobile" class="form-control" ng-model="business.mobile" ng-minlength="3" mongoose-error/>\r\n\r\n	          <p class="help-block" ng-show="(form.mobile.$error.minlength || form.mobile.$error.required) && submitted">\r\n	            Le numéro de téléphone mobile est incomplet.\r\n	          </p>\r\n	          <p class="help-block" ng-show="form.mobile.$error.mongoose">\r\n	            {{ errors.mobile }}\r\n	          </p>\r\n	        </div>\r\n	      </div>\r\n\r\n	      <!-- phone -->\r\n	      <div class="col-sm-2">\r\n	        <div class="form-group" ng-class="{ \'has-success\': form.phone.$valid && submitted,\r\n	                                            \'has-error\': form.phone.$invalid && submitted }">\r\n\r\n	          <label>Téléphone</label>\r\n	          <input type="tel" name="phone" class="form-control" ng-model="business.phone" ng-minlength="3" mongoose-error/>\r\n	          \r\n	          <p class="help-block" ng-show="form.phone.$error.mongoose">\r\n	            {{ errors.phone }}\r\n	          </p>\r\n	        </div>\r\n	      </div>\r\n\r\n	    </div>\r\n\r\n\r\n\r\n	    <hr>\r\n	    <h4>Web</h4>\r\n\r\n	    <!-- urls -->\r\n	    <div class="row">\r\n	        <div class="col-sm-4 col-sm-offset-3">\r\n	            <label>Lien du site web</label>\r\n	            \r\n	            <div class="form-group" ng-class="{ \'has-success\': form.siteURL.$valid && submitted, \'has-error\': form.siteURL.$invalid && submitted }">\r\n				<input type="url" name="siteURL" class="form-control" ng-model="business.siteURL" mongoose-error/>	\r\n	              <p class="help-block" ng-show="form.siteURL.$error.mongoose">\r\n	                {{ errors.siteURL }}\r\n	              </p>\r\n	            </div>\r\n	        </div>\r\n\r\n	        <div class="col-sm-4">\r\n	          <div class="form-group" ng-class="{ \'has-success\': form.facebookURL.$valid && submitted, \'has-error\': form.facebookURL.$invalid && submitted }">\r\n	            <label>Lien de la page Facebook</label>\r\n\r\n	            <input type="url" name="facebookURL" class="form-control" ng-model="business.facebookURL" mongoose-error/>	\r\n	            <p class="help-block" ng-show="form.facebookURL.$error.mongoose">\r\n	              {{ errors.facebookURL }}\r\n	            </p>\r\n	          </div>\r\n	        </div>\r\n	    </div>\r\n	    <hr>\r\n\r\n	    <!-- buttons -->\r\n	    <div class="row">\r\n	      <div class="col-sm-4 col-sm-offset-3">\r\n	        <button class="btn btn-success" type="submit">\r\n	          Créer le salon\r\n	        </button>\r\n	        <a class="btn btn-danger" href="/">\r\n	          Annuler\r\n	        </a>\r\n	      </div>\r\n	    </div>\r\n\r\n	  </form>\r\n  </div>\r\n  <hr>\r\n</div>\r\n'),a.put("app/account/login/login.html",'<div ng-include="\'components/navbar/navbar.html\'"></div>\r\n\r\n<div class="container">\r\n  <div class="row">\r\n    <div class="col-sm-6 col-sm-offset-3 col-xs-8 col-xs-offset-2">\r\n      <h1>Connexion</h1>\r\n    </div>\r\n    <div class="col-sm-6 col-sm-offset-3 col-xs-8 col-xs-offset-2">\r\n      <form class="form" name="form" ng-submit="login(form)" novalidate>\r\n\r\n        <div class="form-group">\r\n          <label>Email</label>\r\n\r\n          <input type="email" name="email" class="form-control" ng-model="user.email" required>\r\n        </div>\r\n\r\n        <div class="form-group">\r\n          <label>Password</label>\r\n\r\n          <input type="password" name="password" class="form-control" ng-model="user.password" required>\r\n        </div>\r\n\r\n        <div class="form-group has-error">\r\n          <p class="help-block" ng-show="form.email.$error.required && form.password.$error.required && submitted">\r\n             Veillez entrer votre mot de passe et email.\r\n          </p>\r\n          <p class="help-block" ng-show="form.email.$error.email && submitted">\r\n              Veillez entrer un email valide.\r\n          </p>\r\n\r\n          <p class="help-block">{{ errors.other }}</p>\r\n        </div>\r\n\r\n        <div>\r\n          <button class="btn btn-default btn-lg btn-login" type="submit">\r\n            Se connecter\r\n          </button>\r\n          <a class="btn btn-default btn-lg btn-register" href="/signup">\r\n            Créer un compte\r\n          </a>\r\n        </div>\r\n\r\n<!--         <hr>\r\n        <div>\r\n          <a class="btn btn-facebook" href="" ng-click="loginOauth(\'facebook\')">\r\n            <i class="fa fa-facebook"></i> Connect with Facebook\r\n          </a>\r\n          <a class="btn btn-google-plus" href="" ng-click="loginOauth(\'google\')">\r\n            <i class="fa fa-google-plus"></i> Connect with Google+\r\n          </a>\r\n        </div> -->\r\n      </form>\r\n    </div>\r\n  </div>\r\n  <hr>\r\n</div>\r\n'),a.put("app/account/notifs/notifs.html",'<div ng-include="\'components/navbar/navbar.html\'"></div>\r\n\r\n<div class="container">\r\n	<div class="row">\r\n		<div class="col-sm-8">\r\n			<h1>Notifications reçues</h1>\r\n		</div>\r\n		<div class="col-sm-4 col-sm-offset-4">\r\n			<div ng-repeat="notif in notifications">\r\n\r\n				<h3>{{notif.title}}</h3>\r\n				<p>{{notif.text}}</p>\r\n				\r\n				<hr>\r\n\r\n				<p>Demande de : {{notif.emitterName}}</p>\r\n				<p>Provient de : {{notif.businessName}}</p>\r\n				<p>Status de la requête : <strong>{{notif.statusParsed}}</strong></p>\r\n\r\n				<button ng-show="notif.status === \'not processed\'" ng-click="accept(notif, $index)" class="btn btn-success">Accepter</button>\r\n				<button ng-show="notif.status === \'not processed\'" ng-click="refuse(notif, $index)" class="btn btn-danger">Refuser</button>\r\n			</div>\r\n			<p ng-show="message">{{message}}</p>\r\n		</div>\r\n	</div>\r\n</div>\r\n'),a.put("app/account/rdv/rdv.html",'<div ng-include="\'components/navbar/navbar.html\'"></div>\n\n<div class="container">\n	<div class="row">\n		<div class="col-sm-8 col-sm-offset-2">\n			<h1>Mes rendez-vous</h1>\n		</div>\n		\n		<div class="col-sm-8 col-sm-offset-2">\n			<table class="table">\n				<thead>\n					<tr>\n						<th>Salon</th>\n						<th>Staff</th>\n						<th>Date</th>\n						<th>Début</th>\n						<th>Fin</th>\n						<th>Prestation</th>\n					</tr>\n				</thead>\n				<tbody>\n					<tr ng-repeat="rdv in rendezvous">\n						<td>{{rdv.business.businessName}}</td>\n						<td>{{rdv.staff.staffName}}</td>\n						<td>{{rdv.startHour | date:\'fullDate\'}}</td>\n						<td>{{rdv.startHour | date:\'shortTime\'}}</td>\n						<td>{{rdv.endHour | date:\'shortTime\'}}</td>\n						<td>{{rdv.prestation.prestationRdvName}}</td>\n					</tr>\n				</tbody>\n			</table>\n		</div>\n	</div>\n</div>'),a.put("app/account/settings/settings.html",'<div ng-include="\'components/navbar/navbar.html\'"></div>\n\n<div class="container">\n  <div class="row">\n    <div class="col-sm-12">\n      <h1>Changement de mot de passe</h1>\n    </div>\n    <div class="col-sm-12">\n      <form class="form" name="form" ng-submit="changePassword(form)" novalidate>\n\n        <div class="form-group">\n          <label>Mot de passe actuel</label>\n\n          <input type="password" name="password" class="form-control" ng-model="user.oldPassword"\n                 mongoose-error/>\n          <p class="help-block" ng-show="form.password.$error.mongoose">\n              {{ errors.other }}\n          </p>\n        </div>\n\n        <div class="form-group">\n          <label>Nouveau mot de passe</label>\n\n          <input type="password" name="newPassword" class="form-control" ng-model="user.newPassword"\n                 ng-minlength="3"\n                 required/>\n          <p class="help-block"\n             ng-show="(form.newPassword.$error.minlength || form.newPassword.$error.required) && (form.newPassword.$dirty || submitted)">\n            Le mot de passe doit être de 3 charactères au minimum.\n          </p>\n        </div>\n\n        <p class="help-block"> {{ message }} </p>\n\n        <button class="btn btn-lg btn-primary" type="submit">Confirmer</button>\n      </form>\n    </div>\n  </div>\n</div>'),a.put("app/account/signup/signup.html",'<div ng-include="\'components/navbar/navbar.html\'"></div>\r\n\r\n<div class="container">\r\n  <div class="row">\r\n    <div class="col-sm-8 col-sm-offset-2 col-xs-10 col-xs-offset-1">\r\n      <h1>Inscription</h1>\r\n    </div>\r\n\r\n      <form class="form" name="form" ng-submit="register(form)" novalidate>\r\n\r\n        <div class="row">\r\n          <div class="col-sm-4 col-sm-offset-2 col-xs-5 col-xs-offset-1">\r\n            <!-- First name -->\r\n            <div class="form-group" ng-class="{ \'has-success\': form.firstName.$valid && submitted,\r\n                                                \'has-error\': form.firstName.$invalid && submitted }">\r\n              <label>Prénom <i class="fa fa-asterisk"></i></label>\r\n\r\n              <input type="text" name="firstName" class="form-control" ng-model="user.firstName"\r\n                     required/>\r\n              <p class="help-block" ng-show="form.firstName.$error.required && submitted">\r\n                Un prénom est requis.\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <div class="col-sm-4 col-xs-5">\r\n            <!-- Last name -->\r\n            <div class="form-group" ng-class="{ \'has-success\': form.lastName.$valid && submitted,\r\n                                                \'has-error\': form.lastName.$invalid && submitted }">\r\n              <label>Nom <i class="fa fa-asterisk"></i></label>\r\n\r\n              <input type="text" name="lastName" class="form-control" ng-model="user.lastName"\r\n                     required/>\r\n              <p class="help-block" ng-show="form.lastName.$error.required && submitted">\r\n                Un nom est requis.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n\r\n\r\n\r\n        \r\n        <div class="row">\r\n          <!-- Email -->\r\n          <div class="col-sm-4 col-sm-offset-2 col-xs-5 col-xs-offset-1">\r\n            <div class="form-group" ng-class="{ \'has-success\': form.email.$valid && submitted,\r\n                                                \'has-error\': form.email.$invalid && submitted }">\r\n              <label>Email <i class="fa fa-asterisk"></i></label>\r\n\r\n              <input type="email" name="email" class="form-control" ng-model="user.email"\r\n                     required\r\n                     mongoose-error/>\r\n              <p class="help-block" ng-show="form.email.$error.email && submitted">\r\n                Ce n\'est pas une adresse mail valide.\r\n              </p>\r\n              <p class="help-block" ng-show="form.email.$error.required && submitted">\r\n                Entrez une adresse mail.\r\n              </p>\r\n              <p class="help-block" ng-show="form.email.$error.mongoose">\r\n                {{ errors.email }}\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <div class="col-sm-4 col-xs-5">\r\n            <!-- Password -->\r\n            <div class="form-group" ng-class="{ \'has-success\': form.password.$valid && submitted,\r\n                                                \'has-error\': form.password.$invalid && submitted }">\r\n              <label>Password <i class="fa fa-asterisk"></i></label>\r\n\r\n              <input type="password" name="password" class="form-control" ng-model="user.password"\r\n                     ng-minlength="3"\r\n                     required\r\n                     mongoose-error/>\r\n              <p class="help-block"\r\n                 ng-show="(form.password.$error.minlength || form.password.$error.required) && submitted">\r\n                Le mot de passe doit contenir au moins 3 charactères.\r\n              </p>\r\n              <p class="help-block" ng-show="form.password.$error.mongoose">\r\n                {{ errors.password }}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n\r\n        \r\n\r\n        <!-- Date of birth & gender -->\r\n        <div class="row">\r\n            <div class="col-sm-4 col-sm-offset-2 col-xs-5 col-xs-offset-1">\r\n                <label>Date de naissance <i class="fa fa-asterisk"></i></label>\r\n                \r\n                <div class="form-group" ng-class="{ \'has-success\': form.dateOfBirth.$valid && submitted, \'has-error\': form.dateOfBirth.$invalid && submitted }">\r\n                  <p class="input-group">\r\n                    <input type="text" class="form-control" datepicker-popup="{{format}}" name="dateOfBirth" ng-model="user.dateOfBirth" is-open="opened" max-date="maxDate" datepicker-options="dateOptions" date-disabled="disabled(date, mode)" required mongoose-error close-text="Close" />\r\n                    <span class="input-group-btn">\r\n                      <button type="button" class="btn btn-default" ng-click="open($event)"><i class="glyphicon glyphicon-calendar"></i></button>\r\n                    </span>\r\n                  </p>\r\n                  <p class="help-block"\r\n                     ng-show="(form.password.$error.required) && submitted">\r\n                    Ce champ est obligatoire.\r\n                  </p>\r\n                  <p class="help-block" ng-show="form.dateOfBirth.$error.mongoose">\r\n                    {{ errors.dateOfBirth }}\r\n                  </p>\r\n                </div>\r\n            </div>\r\n\r\n            <div class="col-sm-4 col-xs-5">\r\n              <div class="form-group" ng-class="{ \'has-success\': form.gender.$valid && submitted, \'has-error\': form.gender.$invalid && submitted }">\r\n                <label>Sexe <i class="fa fa-asterisk"></i></label>\r\n\r\n                <select class="form-control" name="gender" ng-model="user.gender" required mongoose-error>\r\n                  <option value="homme">Homme</option>\r\n                  <option value="femme">Femme</option>\r\n                </select>\r\n                  <p class="help-block"\r\n                     ng-show="(form.password.$error.required) && submitted">\r\n                    Ce champ est obligatoire.\r\n                  </p>\r\n                <p class="help-block" ng-show="form.gender.$error.mongoose">\r\n                  {{ errors.gender }}\r\n                </p>\r\n              </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- localite custom template -->\r\n        <script type="text/ng-template" id="localiteTemplate.html">\r\n          <a>\r\n            <span bind-html-unsafe="match.model.Commune | typeaheadHighlight:query"></span>\r\n            (<span bind-html-unsafe="match.model.NPA | typeaheadHighlight:query"></span>)\r\n          </a>\r\n        </script>\r\n\r\n        <div class="row">\r\n          <div class="col-sm-4 col-sm-offset-2 col-xs-4 col-xs-offset-1"><label>Localité</label>\r\n            <input type="text" ng-model="user.loc" ng-bind="user.loc.Commune" typeahead-min-length="3" typeahead-editable="false" typehead-on-select(model) typeahead="geodata as geodata.Commune for geodata in geodatas | filter:$viewValue" typeahead-template-url="localiteTemplate.html" class="form-control">\r\n          </div>\r\n          <div class="col-sm-2 col-xs-3"><label>NPA</label>\r\n            <input type="text" ng-model="user.loc" ng-bind="user.loc.NPA" typeahead-min-length="2" typeahead-editable="false" typehead-on-select(model) typeahead="geodata as geodata.NPA for geodata in geodatas | filter:$viewValue | limitTo:8" class="form-control" disabled>\r\n          </div>\r\n          <div class="col-sm-2 col-xs-3"><label>Canton</label>\r\n            <input type="text" ng-model="user.loc" ng-bind="user.loc.Canton" typehead-on-select(model) typeahead-editable="false" typeahead="geodata as geodata.Canton for geodata in geodatas | filter:$viewValue | limitTo:8" class="form-control" disabled>\r\n          </div>\r\n        </div>\r\n\r\n        <hr>\r\n        <div class="row">\r\n          <div class="col-sm-4 col-sm-offset-2 col-xs-10 col-xs-offset-1">\r\n            <input type="checkbox" ng-model="user.manager"> \r\n            <label>Je suis un gérant de salon</label>\r\n          </div>\r\n        </div>\r\n\r\n        <hr>\r\n        <!-- Buttons -->\r\n        <div class="row">\r\n          <div class="col-sm-4 col-sm-offset-2 col-xs-offset-1">\r\n            <button class="btn btn-default btn-lg btn-login" type="submit">\r\n              Créer un compte\r\n            </button>\r\n            <a class="btn btn-default btn-lg btn-register" href="/login">\r\n              Se connecter\r\n            </a>\r\n          </div>\r\n        </div>\r\n\r\n<!--         <hr>\r\n        <div class="col-sm-8 col-sm-offset-2">\r\n          <a class="btn btn-facebook" href="" ng-click="loginOauth(\'facebook\')">\r\n            <i class="fa fa-facebook"></i> Connect with Facebook\r\n          </a>\r\n          <a class="btn btn-google-plus" href="" ng-click="loginOauth(\'google\')">\r\n            <i class="fa fa-google-plus"></i> Connect with Google+\r\n          </a>\r\n        </div> -->\r\n      </form>\r\n  </div>\r\n</div>\r\n'),
a.put("app/account/staff/staff.html",'<div ng-include="\'components/navbar/navbar.html\'"></div>\r\n\r\n<div class="container">\r\n	<div class="row">\r\n    \r\n    	<div class="col-sm-8">\r\n      		<h1>Creation du profil staff</h1>\r\n    	</div>\r\n\r\n    	<form class="form" name="form" ng-submit="register(form)">\r\n\r\n		  	<!-- name -->\r\n		    <div class="row">\r\n		      <div class="col-sm-4 col-sm-offset-3 col-xs-6 col-xs-offset-3">\r\n		        <div class="form-group" ng-class="{ \'has-success\': form.name.$valid && submitted,\r\n		                                            \'has-error\': form.name.$invalid && submitted }">\r\n		          <label>Nom du staff <i class="fa fa-asterisk"></i></label>\r\n\r\n		          <input type="text" name="name" class="form-control" ng-model="staff.name" required/>\r\n		          <p class="help-block" ng-show="form.name.$error.required && submitted">\r\n		            Un nom est requis.\r\n		          </p>\r\n		        </div>\r\n		      </div>\r\n		    </div>\r\n\r\n		    <hr>\r\n		    <h4>Contact</h4>\r\n\r\n		    <div class="row">\r\n\r\n		      <!-- email -->\r\n		      <div class="col-sm-4 col-sm-offset-3 col-xs-6 col-xs-offset-3">\r\n		        <div class="form-group" ng-class="{ \'has-success\': form.email.$valid && submitted,\r\n		                                            \'has-error\': form.email.$invalid && submitted }">\r\n		          <label>Email</label>\r\n\r\n		          <input type="email" name="email" class="form-control" ng-model="staff.email"\r\n		                 mongoose-error/>\r\n		          <p class="help-block" ng-show="form.email.$error.email && submitted">\r\n		            Ce n\'est pas une adresse mail valide.\r\n		          </p>\r\n		          <p class="help-block" ng-show="form.email.$error.required && submitted">\r\n		            Entrez une adresse mail.\r\n		          </p>\r\n		          <p class="help-block" ng-show="form.email.$error.mongoose">\r\n		            {{ errors.email }}\r\n		          </p>\r\n		        </div>\r\n		      </div>\r\n\r\n		    </div>\r\n		    <div class="row">\r\n\r\n		      <!-- mobile -->\r\n		      <div class="col-sm-2 col-sm-offset-3 col-xs-3 col-xs-offset-3">\r\n		        <div class="form-group" ng-class="{ \'has-success\': form.mobile.$valid && submitted,\r\n		                                            \'has-error\': form.mobile.$invalid && submitted }">\r\n		          \r\n		          <label>Mobile</label>\r\n		          <input type="tel" name="mobile" class="form-control" \r\n		          ng-model="staff.mobile" ng-minlength="3" mongoose-error/>\r\n\r\n		          <p class="help-block" ng-show="(form.mobile.$error.minlength || form.mobile.$error.required) && submitted">\r\n		            Le numéro de téléphone mobile est incomplet.\r\n		          </p>\r\n		          <p class="help-block" ng-show="form.mobile.$error.mongoose">\r\n		            {{ errors.mobile }}\r\n		          </p>\r\n		        </div>\r\n		      </div>\r\n\r\n		      <!-- phone -->\r\n		      <div class="col-sm-2 col-xs-3">\r\n		        <div class="form-group" ng-class="{ \'has-success\': form.phone.$valid && submitted,\r\n		                                            \'has-error\': form.phone.$invalid && submitted }">\r\n\r\n		          <label>Téléphone</label>\r\n		          <input type="tel" name="phone" class="form-control" \r\n		          ng-model="staff.phone" ng-minlength="3" mongoose-error/>\r\n		          \r\n		          <p class="help-block" ng-show="(form.phone.$error.minlength || form.phone.$error.required) && submitted">\r\n		            Le numéro de téléphone fixe est incomplet.\r\n		          </p>\r\n		          <p class="help-block" ng-show="form.phone.$error.mongoose">\r\n		            {{ errors.phone }}\r\n		          </p>\r\n		        </div>\r\n		      </div>\r\n\r\n		    </div>\r\n		    <hr>\r\n\r\n		    <!-- buttons -->\r\n		    <div class="row">\r\n		      <div class="col-sm-4 col-sm-offset-3 col-xs-6 col-xs-offset-3">\r\n		        <button class="btn btn-success" type="submit">\r\n		          Créer le profil\r\n		        </button>\r\n		        <a class="btn btn-danger" href="/">\r\n		          Annuler\r\n		        </a>\r\n		      </div>\r\n		    </div>\r\n\r\n    	</form>\r\n\r\n	</div>\r\n</div>'),a.put("app/business/business-fb-page/business-fb-page.html",'<div ng-include="\'components/navbar/navbar.html\'"></div>\r\n\r\n<div class="container">\r\n	<div class="row">\r\n		<div class="col-sm-12">\r\n			<h1>Gérer la page Facebook du salon</h1>\r\n			<hr>\r\n\r\n			<h3>Se connecter à votre compte Facebook</h3>\r\n			<button ng-hide="isConnected === true" class="btn btn-info" ng-click="login(form)">Se connecter à Facebook</button>\r\n			<p ng-show="isConnected === true"><i class="fa fa-check-circle"></i> Vous êtes connecté à Facebook.</p>\r\n			<hr>\r\n			\r\n			<!-- Infos et référencement de l\'ID de page -->\r\n			<h3>Référencer l\'identifiant de page</h3>\r\n			<p>Afin de pouvoir intéragir avec votre page, vous devez référencer son identifiant dans notre système.</p>\r\n			<p>Pour se faire, veillez réaliser les étapes suivantes :</p>\r\n			<ul>\r\n				<li>Aller sur la page Facebook de votre salon</li>\r\n				<li>Rendez-vous dans "Paramètres"</li>\r\n				<li>Cliquez sur l\'onglet "Informations sur la Page"</li>\r\n				<li>Référencer dans le champs ci-dessous la valeur de l\'attribut "Identifiant de Page Facebook"</li>\r\n			</ul>\r\n\r\n			<form name="form" class="form" ng-show="business.fbPageId === undefined">\r\n				<div class="form-group">\r\n					<label>Identifiant de la page Facebook</label>\r\n					<input class="form-control" type="text" name="pageId" ng-model="pageId" ng-minlenght="15" ng-maxlength="16" placeholder="<votre identifiant de page>" required>\r\n				</div>\r\n				<button type="submit" class="btn btn-default" ng-click="sendPageId(pageId)">Envoyer</button>\r\n			</form>\r\n			<p ng-hide="business.fbPageId === undefined"><i class="fa fa-check-circle"></i>\r\n Votre identifiant de page est réferencé : <b>{{business.fbPageId}}<b></p>\r\n\r\n			<hr>\r\n\r\n			<!-- Boutons d\'interation avec la page -->\r\n			<h3>Ajouter l\'app et publier un lien sur la page du salon</h3>\r\n			<p ng-show="business.fbPageId === undefined"><i class="fa fa-times-circle"></i>\r\nVeillez réferencer l\'identifiant de votre page afin de déverouiller les interactions avec votre page<b></p>\r\n			<button class="btn btn-default" ng-click="addApp()" ng-disabled="business.fbPageId === undefined">Ajouter l\'app à ma page</button>\r\n			<button class="btn btn-default" ng-click="publishLink(business.fbPageId)" ng-disabled="business.fbPageId === undefined">Publier le lien sur ma page</button>\r\n		</div>\r\n		\r\n	</div>\r\n</div>'),a.put("app/business/business-prestations/business-prestations.html",'<div ng-include="\'components/navbar/navbar.html\'"></div>\r\n\r\n<div class=container>\r\n\r\n	<!-- error feedback -->\r\n	<div>\r\n		<alert ng-repeat="alert in alerts" type="danger" class="helpblock"  dismiss-on-timeout="1000" close="closeAlert($index)">\r\n			<i class="fa fa-exclamation-triangle"></i> {{alert.field}}  //  {{alert.text}}\r\n		</alert>\r\n	</div>\r\n\r\n	<!-- Formulaire d\'ajout de prestation -->\r\n	<div class="row hidden-xs" ng-show="addPrestationForm === true">\r\n		<div class="col-sm-12">\r\n			<h3>Ajout d\'une prestation</h3>\r\n			<hr>\r\n		</div>\r\n		<div class="col-sm-6 col-sm-offset-3">\r\n			<form class="form" name="form" novalidate>\r\n\r\n		        <!-- name -->\r\n		        <div class="form-group" ng-class="{ \'has-success\': form.name.$valid && submitted,\r\n		                                            \'has-error\': form.name.$invalid && submitted }">\r\n		          <label>Nom</label>\r\n\r\n		          <input type="text" name="name" class="form-control" ng-model="prestation.name" placeholder="p. ex. coupe de cheveux" required/>\r\n		          <p class="help-block" ng-show="form.name.$error.required && submitted">\r\n		            Un nom est requis.\r\n		          </p>\r\n		        </div>\r\n\r\n		        <!-- Description -->\r\n		        <div class="form-group" ng-class="{ \'has-success\': form.description.$valid && submitted,\r\n		                                            \'has-error\': form.description.$invalid && submitted }">\r\n		          <label>Description</label>\r\n\r\n		          <textarea name="description" class="form-control" ng-model="prestation.description" ng-minlength="1" ng-maxlength="200" placeholder="une description de moins de 200 charactères"  required/>\r\n		          <p class="help-block" ng-show="form.description.$error.required && submitted">\r\n		            Une description est requise.\r\n		          </p>\r\n			      <p class="help-block" ng-show="form.description.$error.maxlength">Trop long! 200 charactères maximum.</p>\r\n		        </div>\r\n\r\n		        <!-- duration -->\r\n				<div class="form-group">\r\n				  <label for="duration">Durée (minutes) :</label>\r\n					<select class="form-control" id="duration" ng-model="prestation.duration" ng-options="duration.label for duration in durations" required>\r\n						 <option value=""> --- Choisissez une durée --- </option>\r\n					</select>\r\n				</div>\r\n\r\n        	<!-- Buttons -->\r\n	        <div class="button-margins">\r\n	          <button class="btn btn-success" type="submit" ng-click="addPrestation(form)">\r\n	           	Envoyer\r\n	          </button>\r\n	          <button class="btn btn-danger" ng-click="cancelAddForm()">\r\n	           	Annuler\r\n	          </button>\r\n	        </div>\r\n\r\n			</form>\r\n		</div>\r\n	</div>\r\n\r\n	<div class="row hidden-xs">\r\n		<button class="btn btn-success" ng-click="addPrestationForm = true" ng-show="addPrestationForm === false"><i class="fa icon-tab fa-plus"></i> Ajouter une prestation</button>\r\n	</div>\r\n\r\n	<hr class="hidden-xs">\r\n\r\n	<div class="row" ng-repeat="prestation in prestations">\r\n\r\n		<!-- Entête des prestations -->\r\n		<div class="row">\r\n			<div class="col-sm-12">\r\n				<!-- visu -->\r\n				<h3 ng-show="editPrestationForm === false">\r\n					{{prestation.name}} \r\n					<button class="btn hidden-xs btn-primary btn-sm" ng-click="editPrestationCopy(prestation); editPrestationForm = true">Modifier</button> \r\n					<button class="btn hidden-xs btn-danger btn-sm" ng-click="deletePrestation(prestation, $index)">Supprimer</button>\r\n				</h3>\r\n\r\n				<!-- modif -->\r\n				<div ng-show="editPrestationForm === true" class="col-sm-5">\r\n					<button  class="btn hidden-xs btn-success btn-sm" ng-click="updatePrestation(formPrestation, initialDuration, $index)">Confirmer</button> \r\n					<button class="btn hidden-xs btn-danger btn-sm" ng-click="editPrestationForm = false">Annuler</button>\r\n					<input type="text" class="form-control" ng-model="formPrestation.name" required>\r\n				</div>\r\n			</div>\r\n		</div>\r\n\r\n		<div class="row">\r\n			\r\n			<!-- visu prestation -->\r\n			<div class="col-sm-5 hr-right" ng-show="editPrestationForm === false">\r\n				<h4>Description</h4>\r\n				<p>{{prestation.description}}</p>\r\n				<hr class="hidden-xs">\r\n				<h4>Durée</h4>\r\n				<p>{{prestation.duration}} minutes</p>\r\n			</div>\r\n\r\n			<!-- modif prestation -->\r\n			<div class="col-sm-5 hr-right" ng-show="editPrestationForm === true">\r\n				<h4>Description</h4>\r\n				<textarea class="form-control" ng-model="formPrestation.description"></textarea>\r\n				<hr>\r\n				<h4>Durée</h4>\r\n				<select class="form-control" id="duration" ng-model="initialDuration" ng-options="duration.label for duration in durations" required>\r\n					 <option value=""> --- Choisissez une durée --- </option>\r\n				</select>\r\n			</div>\r\n\r\n			<!-- table des prix -->\r\n			<div class="col-sm-7">\r\n				<table class="table">\r\n					<thead>\r\n						<tr>\r\n							<th>Categorie</th>\r\n							<th>Sexe </th>\r\n							<th>Age min</th>\r\n							<th>Age max</th>\r\n							<th>Prix</th>\r\n							<th class="hidden-xs">Actions</th>\r\n						</tr>\r\n						</thead>\r\n						<tbody>\r\n\r\n						\r\n						<tr ng-repeat="price in prestation.prices">\r\n							<!-- liste affichage -->\r\n							<td ng-show="editPriceForm === false">{{price.categoryName}}</td>\r\n							<td ng-show="editPriceForm === false">{{price.gender}}</td>\r\n							<td ng-show="editPriceForm === false">{{price.ageLowLimit}}</td>\r\n							<td ng-show="editPriceForm === false">{{price.ageHighLimit}}</td>\r\n							<td ng-show="editPriceForm === false">{{price.price}}</td>\r\n\r\n							<!-- formulaire modif -->\r\n							<td ng-show="editPriceForm === true">\r\n								<input class="input-form-big" type="text" ng-model="form.categoryName" ng-maxlength="20" />\r\n							</td>\r\n							<td ng-show="editPriceForm === true">\r\n								<select  class="input-form-select" ng-model="form.gender" required>\r\n									<option value="mixte" selected>mixte</option>\r\n								    <option value="homme">homme</option>\r\n								    <option value="femme">femme</option>\r\n								 </select>\r\n							</td>\r\n							<td ng-show="editPriceForm === true">\r\n								<input class="input-form-small" type="number" ng-model="form.ageLowLimit" min="1" max="99" ngMaxlength="2" ngMinlength="1"/>\r\n							</td>\r\n							<td ng-show="editPriceForm === true">\r\n								<input class="input-form-small" type="number" ng-model="form.ageHighLimit" min="1" max="99" ngMaxlength="2" ngMinlength="1" />\r\n							</td>\r\n							<td ng-show="editPriceForm === true">\r\n								<input class="input-form-med" type="number" ng-model="form.price"  min="1" max="999" ngMaxlength="3" ngMinlength="1" />\r\n							</td>\r\n\r\n							<!-- colonne boutons -->\r\n							<td class="hidden-xs">\r\n								<!-- bouton update -->\r\n								<div class="btn btn-success label" ng-click="editPriceForm = false; updatePrice(prestation._id, price._id, form)" ng-show="editPriceForm === true"><i class="fa icon-tab fa-check"></i></div>\r\n								<div class="btn btn-danger label" ng-click="editPriceForm = false" ng-show="editPriceForm === true"><i class="fa icon-tab fa-close"></i></div>\r\n\r\n								<!-- bouton visu -->\r\n								<div class="btn btn-primary label" ng-click="editPriceCopy(price); editPriceForm = true" ng-show="editPriceForm === false" ng-disabled="addPriceForm === true || editPriceForm === true"><i class="fa icon-tab fa-pencil-square-o"></i></div>\r\n								<div class="btn btn-danger label" ng-click="deletePrice(prestation._id, price._id, $parent.$index, $index)" ng-show="editPriceForm === false" ng-disabled="addPriceForm === true || editPriceForm === true"><i class="fa icon-tab fa-trash-o"></i></div>\r\n							</td>\r\n						</tr>\r\n\r\n\r\n						<!-- Formulaire d\'ajout -->\r\n						<tr ng-show="addPriceForm === true">\r\n							<td>\r\n								<input class="input-form-big" type="text" ng-model="formAdd.categoryName" ng-maxlength="20" />\r\n							</td>\r\n							<td>\r\n								<select class="input-form-select" ng-model="formAdd.gender" required>\r\n									<option value="mixte" selected>mixte</option>\r\n								    <option value="homme">homme</option>\r\n								    <option value="femme">femme</option>\r\n								 </select>\r\n							</td>\r\n							<td>\r\n								<input class="input-form-small" type="number" ng-model="formAdd.ageLowLimit" min="1" max="99" ngMaxlength="2" ngMinlength="1"/>\r\n							</td>\r\n							<td>\r\n								<input class="input-form-small" type="number" ng-model="formAdd.ageHighLimit" min="1" max="99" ngMaxlength="2" ngMinlength="1" />\r\n							</td>\r\n							<td>\r\n								<input class="input-form-med" type="number" ng-model="formAdd.price"  min="1" max="999" ngMaxlength="3" ngMinlength="1" />\r\n							</td>\r\n							<td class="hidden-xs">\r\n								<div class="btn btn-success label" ng-click="addPrice(prestation._id, formAdd); addPriceForm=false"><i class="fa icon-tab fa-plus"></i></div>\r\n								<div class="btn btn-danger label" ng-click="addPriceForm=false"><i class="fa icon-tab fa-times"></i></div>\r\n							</td>\r\n						</tr>\r\n					</tbody>\r\n				</table> \r\n				<div class="btn btn-success btn-sm pull-right hidden-xs" ng-click="addPriceForm = true" ng-show="addPriceForm === false" ng-disabled="editPriceForm === true"><i class="fa icon-tab fa-plus"></i> Ajouter un nouveau prix</div>\r\n			</div>\r\n		</div>\r\n		<hr class="show-xs">\r\n	</div>\r\n</div>'),a.put("app/business/business-rendezvous/business-rendezvous.html",'<div ng-include="\'components/navbar/navbar.html\'"></div>\r\n\r\n<div id="container">\r\n	<div class="row">\r\n		<form class="form" name="form" ng-submit="search(defaultWeek, defaultStaff)" novalidate>\r\n			<div class="col-sm-4 col-sm-offset-3 col-xs-10 col-xs-offset-1 col-md-3 col-md-offset-4">\r\n\r\n				<div class="form-group">\r\n				  <label>Choissisez la semaine de recherches</label>\r\n				  <select class="form-control" ng-model="defaultWeek" ng-options="week.label for week in weeks">\r\n				    <option value=""> --- Choisir une semaine --- </option>\r\n				  </select>\r\n				</div>\r\n\r\n				<div class="form-group">\r\n				  <label>Choissisez un membre du staff</label>\r\n				  <select class="form-control" ng-model="defaultStaff" ng-options="staff.name for staff in staffs">\r\n				    <option value=""> --- Choisir un staff --- </option>\r\n				  </select>\r\n				</div>\r\n				<button class="btn btn-default" type="submit">\r\n            		Rechercher\r\n          		</button>\r\n			</div>\r\n		</form>\r\n	</div>\r\n\r\n	<hr>\r\n	<p>{{message}}</p>\r\n\r\n	<!-- champ de recherche -->\r\n	<div class="row">\r\n		<div class="col-sm-6 col-sm-offset-3">\r\n			<label ng-show="rendezvous !== undefined">Recherche: <input ng-model="searchText"></label>\r\n		</div>\r\n	</div>\r\n\r\n	<div class="row">\r\n		<div class="col-sm-6 col-sm-offset-3  col-xs-10 col-xs-offset-1 col-md-6 col-md-offset-3">\r\n			<div>\r\n				<table class="table">\r\n					<thead>\r\n						<tr>\r\n							<th>Client</th>\r\n							<th>Prestation</th>\r\n							<th>Date</th>\r\n							<th>Début</th>\r\n							<th>Fin</th>\r\n						</tr>\r\n					</thead>\r\n					<tbody>\r\n						<tr ng-repeat="rdv in rendezvous | filter: searchText">\r\n							<td>{{rdv.client.clientName}}</td>\r\n							<td>{{rdv.prestation.prestationRdvName}}</td>\r\n							<td>{{rdv.startHour | date:\'fullDate\'}}</td>\r\n							<td>{{rdv.startHour | date:\'shortTime\'}}</td>\r\n							<td>{{rdv.endHour | date:\'shortTime\'}}</td>\r\n						</tr>\r\n					</tbody>\r\n				</table>\r\n			</div>\r\n		</div>\r\n	</div>\r\n\r\n</div>'),a.put("app/business/business-schedules/business-schedules.html",'<div ng-include="\'components/navbar/navbar.html\'"></div>\r\n\r\n<div class="container">\r\n\r\n	<div class="row hidden-xs">\r\n		<!-- Formulaire d\'ajout -->\r\n		<button class="btn btn-success pull-left" ng-click="add = true" ng-show="add === false">Ajouter une tranche horaire</button>\r\n		<p class="col-sm-6 col-sm-offset-3">{{invalidForm}}</p>\r\n		<form novalidate>\r\n			<div class="col-sm-6 col-sm-offset-3" ng-show="add === true">\r\n				<div class="row">\r\n					<div class="col-sm-6">\r\n						<label> Jour </label>\r\n						<select class="form-control" ng-options="optionsDay as optionsDay for optionsDay in optionsDay" ng-model="form.dayName" required>\r\n							<option value="">-- sélectionnez un jour --</option>\r\n						</select>\r\n					</div>\r\n					<div class="col-sm-6">\r\n						<label> Description </label>\r\n						<input class="form-control" type="text" ng-model="form.description" placeholder="horaire de <jour>" required>\r\n					</div>\r\n				</div>\r\n				<div class="row">\r\n					<div class="col-sm-6">\r\n						<label> Débute à </label>\r\n						<select class="form-control" ng-model="form.startHour" ng-options="options as options for options in options" required>\r\n							<option value="" selected>-- sélectionnez une heure --</option>\r\n						</select>\r\n					</div>\r\n					<div class="col-sm-6">\r\n						<label> Fini à </label>\r\n						<select class="form-control" ng-model="form.endHour" ng-options="options as options for options in options" required>\r\n							<option value="" selected>-- sélectionnez une heure --</option>\r\n						</select>\r\n					</div>\r\n				</div>\r\n				<div class="row" ng-show="add === true">\r\n					<div class="col-sm-6">\r\n						<label> Jour ouvrable </label>\r\n						<select class="form-control" ng-model="form.workingDay" ng-options="option.value as option.label for option in optionsWorkingDay" required>\r\n							<option value="" selected>-- sélectionnez une valeur --</option>\r\n						</select>\r\n						\r\n					</div>\r\n				</div>\r\n			</div>\r\n		</form>\r\n<!-- 		<div class="col-sm-5" ng-show="add === true">\r\n			<h4>staffs affiliés</h4>\r\n			<div class="checkbox" ng-repeat="staff in staffs">\r\n				<label>\r\n				  <input type="checkbox" ng-model="form.staffs[$index]" name="addStaffs[]" value="{{staff._id}}"> {{staff.name}}\r\n				</label>\r\n			</div>\r\n		</div> -->\r\n\r\n		<div class="row">\r\n			<div class="col-sm-12">\r\n			<button class="hidden-xs btn btn-sm btn-success" ng-click="addSchedule(form);" ng-show="add === true">Envoyer</button>\r\n			<button class="hidden-xs btn btn-sm btn-danger" ng-click="add = false; form = null" ng-show="add === true">Annuler</button>\r\n			</div>\r\n		</div>\r\n	</div>\r\n\r\n	<hr>\r\n	\r\n	<!-- Liste des horaires -->\r\n	<div class="row" ng-repeat="schedule in schedules | orderBy : [\'dayId\', \'startHour\', \'endHour\']">\r\n		<div class="row">\r\n\r\n			<div class="col-sm-6 col-sm-offset-3">\r\n\r\n				<!-- visualisation mode -->\r\n				<div ng-show="modif===false">\r\n					<h4>{{schedule.dayName}}</h4>\r\n					<p>Description : {{schedule.description}}</p>\r\n					<p ng-show="schedule.workingDay === true">Heures : {{schedule.startHour}} - {{schedule.endHour}}</p>\r\n					<p ng-show="schedule.workingDay === true">Jour ouvrable : Oui</p>\r\n					<p ng-show="schedule.workingDay === false">Jour ouvrable : Non</p>\r\n				</div>\r\n\r\n				<!-- edit mode -->\r\n				<div ng-show="modif===true">\r\n					<div class="row">\r\n						<div class="col-sm-6">\r\n							<label> Jour </label>\r\n							<select class="form-control" ng-model="edit.dayName" ng-options="optionsDay as optionsDay for optionsDay in optionsDay" required>\r\n								<option value="">-- sélectionnez un jour --</option>\r\n							</select>\r\n						</div>\r\n						<div class="col-sm-6">\r\n							<label> Description </label>\r\n							<input class="form-control" type="text" ng-bind="edit.description" ng-model="schedule.description">\r\n						</div>\r\n					</div>\r\n					<div class="row">\r\n						<div class="col-sm-6">\r\n							<label> Débute à </label>\r\n							<select class="form-control" ng-model="edit.startHour" ng-options="options as options for options in options">\r\n								<option value="" selected>-- sélectionnez une heure --</option>\r\n							</select>\r\n						</div>\r\n						<div class="col-sm-6">\r\n							<label> Fini à </label>\r\n							<select class="form-control" ng-model="edit.endHour" ng-options="options as options for options in options">\r\n								<option value="" selected>-- sélectionnez une heure --</option>\r\n							</select>\r\n						</div>\r\n					</div>\r\n					<div class="row">\r\n						<div class="col-sm-6">\r\n							<label> Jour ouvrable </label>\r\n							<select class="form-control" ng-model="edit.workingDay" ng-options="option.value as option.label for option in optionsWorkingDay" required>\r\n								<option value="" selected>-- sélectionnez une valeur --</option>\r\n							</select>\r\n						</div>\r\n					</div>\r\n					\r\n				</div>\r\n			</div>\r\n\r\n<!-- 			<div class="col-sm-5 hidden-xs">\r\n				<h4>staffs affiliés</h4>\r\n				\r\n				<ul ng-show="modif===false">\r\n					<li ng-repeat="staff in schedule.staffs">\r\n						{{staff.name}}\r\n					</li>\r\n				</ul>\r\n				\r\n				<div ng-repeat="staff in staffs" ng-show="modif===true">\r\n					<label>\r\n					  <input\r\n					  	ng-model="schedule.staffs"\r\n					    type="checkbox"\r\n					    name="selectedStaff[]"\r\n					    value="{{staff._id}}"\r\n					    ng-checked="selection.indexOf(staff._id) > -1"\r\n					    ng-click="toggleSelection(staff._id)"\r\n					  > {{staff.name}}\r\n					</label>\r\n				</div>\r\n			</div>\r\n			<hr class="show-xs"> -->\r\n		</div>\r\n		<div class="row">\r\n			<div class="hidden-xs col-sm-6 col-sm-offset-3">\r\n				<!-- bouton liste -->\r\n				<button class="btn btn-primary" ng-click="modif=true; editSchedule(schedule, $index)" ng-show="modif===false">Modifier</button>\r\n				<button class="btn btn-danger" ng-click="deleteSchedule(schedule._id, $index)" ng-show="modif===false">Supprimer</button>\r\n				<!-- bouton modif -->\r\n				<button class="btn  btn-success" ng-click="modif=false; updateSchedule(edit, $index)" ng-show="modif===true">Confirmer</button>\r\n				<button class="btn  btn-danger" ng-click="modif=false" ng-show="modif===true">Annuler</button>\r\n				<hr>\r\n			</div>\r\n		</div>\r\n\r\n\r\n	</div>\r\n</div>'),a.put("app/business/business-show/business-show.html",'<div ng-include="\'components/navbar/navbar.html\'"></div>\r\n\r\n<div class="container">\r\n	<div class= "row">\r\n\r\n		<!-- colonne gauche -->\r\n		<div class="col-sm-4">\r\n			<img class="img-rounded hidden-xs" src="/assets/images/2fed6ec4.businessPlaceholder.png" style="max-height:200px" />\r\n		</div>\r\n		\r\n		<!-- colonne centrale -->\r\n		<div class="col-sm-4">\r\n			<!-- title for destop/tablet -->\r\n			<h3 class="hidden-xs">Lieu géographique</h3>\r\n			<hr class="divider hidden-xs">\r\n			<h4 class="hidden-xs">{{business.name}}</h4>\r\n			<!-- title for mobile -->\r\n			<h3 class="hidden-sm hidden-md hidden-lg">{{business.name}}</h3>\r\n			<hr class="divider hidden-sm hidden-md hidden-lg">\r\n\r\n			<p><i class="fa icon-infos fa-building"></i> {{business.zip}} {{business.city}} ({{business.canton}})</p>\r\n			<p><i class="fa icon-infos fa-road"></i> {{business.street}}</p>\r\n		</div>\r\n\r\n		<!-- colonne droite -->\r\n		<div class="col-sm-4">\r\n			<h3>Contact</h3>\r\n			<hr class="divider">\r\n			<p><i class="fa icon-infos fa-phone"></i> {{business.businessContact.phone}}</p>\r\n			<p><i class="fa icon-infos fa-mobile"></i> {{business.businessContact.mobile}}</p>\r\n			<p><i class="fa icon-infos fa-external-link-square"></i> {{business.businessContact.siteURL}}</p>\r\n			<p><i class="fa icon-infos fa-facebook-official"></i> {{business.businessContact.facebookURL}}</p>\r\n		</div>\r\n	</div>\r\n\r\n	<!-- bouton rdv -->\r\n	<div class="row">\r\n		<div class="col-sm-4 col-schedule-btn">\r\n			<a href="/business/{{business._id}}/rendezvous/step1" class="btn btn-primary btn-mgn-bottom"><i class="fa fa-book"> Prendre rendez-vous</i></a>\r\n		</div>\r\n	</div>\r\n\r\n	<!-- colonne horaires  -->\r\n	<div class= "row">\r\n		<div class="col-sm-7 col-sm-offset-4 col-schedule">\r\n			<h3>Horaires du salon</h3>\r\n			<hr class="divider">\r\n			<table class="table">\r\n				<thead>\r\n					<tr>\r\n						<th>Jour</th>\r\n						<th class="hidden-xs">Description</th>\r\n						<th>Débute</th>\r\n						<th>Termine</th>\r\n					</tr>\r\n				</thead>\r\n				<tbody>\r\n					<tr ng-repeat="schedule in business.schedules">\r\n						<td>{{schedule.dayName}}</td>\r\n						<td class="hidden-xs">{{schedule.description}}</td>\r\n						<td>{{schedule.startHour}}</td>\r\n						<td>{{schedule.endHour}}</td>\r\n					</tr>\r\n				</tbody>\r\n			</table> \r\n		</div>\r\n	</div>\r\n\r\n  \r\n\r\n</div>\r\n'),a.put("app/business/business-staffs/business-staffs.html",'<div ng-include="\'components/navbar/navbar.html\'"></div>\r\n\r\n<div class="row">\r\n	<div class="col-sm-6 col-sm-offset-3">\r\n		<h3>Liste du personnel</h3>\r\n		<table class="table">\r\n			<thead>\r\n				<tr>\r\n					<th>Nom</th>\r\n					<th>Email</th>\r\n					<th>Mobile</th>\r\n					<th>Téléphone</th>\r\n					<th>Photo</th>\r\n				</tr>\r\n			</thead>\r\n			<tbody>\r\n				<tr ng-repeat="staff in staffs">\r\n					<td>{{staff.name}}</td>\r\n					<td>{{staff.staffContact.email}}</td>\r\n					<td>{{staff.staffContact.mobile}}</td>\r\n					<td>{{staff.staffContact.phone}}</td>\r\n					<td><img ng-scr="{{staff.photoStaffURL}}"></img></td>\r\n				</tr>\r\n			</tbody>\r\n		</table>\r\n		<hr>\r\n	</div>\r\n</div>\r\n\r\n<div class="row">\r\n	<div class="col-sm-6 col-sm-offset-3">\r\n		<h3>Notifications envoyées</h3>\r\n		<table class="table">\r\n			<thead>\r\n				<tr>\r\n					<th>Destinataire</th>\r\n					<th>Emetteur</th>\r\n					<th>Envoyé le</th>\r\n					<th>Status</th>\r\n					<th class="hidden-xs">Actions</th>\r\n				</tr>\r\n			</thead>\r\n			<tbody>\r\n				<tr ng-repeat="notif in notifs">\r\n					<td>{{notif.receptorName}}</td>\r\n					<td>{{notif.emitterName}}</td>\r\n					<td>{{notif.createdOn}}</td>\r\n					<td>{{notif.status}}</td>\r\n					<td class="hidden-xs"><button class="btn btn-danger" ng-click="deleteNotification(notif._id, $index)"><i class="fa icon-tab fa-trash-o"></i></button></td>\r\n				</tr>\r\n			</tbody>\r\n		</table>\r\n		<hr>\r\n	</div>\r\n</div>\r\n\r\n<div class="row hidden-xs">\r\n	<div class="col-sm-6 col-sm-offset-3">\r\n		<h3>Ajout d\'un staff</h3>\r\n		<button ng-click="edit = true" ng-show="edit === false" class="btn btn-success">Envoyer une notif</button>\r\n		\r\n		<div ng-show="edit === true">\r\n			<form name="selectUser">\r\n			    <div class="form-group col-xs-10 col-sm-8 col-md-6 col-lg-4 \r\n			                col-xs-offset-1 col-sm-offset-2 col-md-offset-3 col-lg-offset-4">\r\n			        <h4>Sélectionner un utilisateur existant</h4>\r\n			        <input type="text" ng-model="form" typeahead-min-length="2" typeahead="user as user.name for user in users | filter:$viewValue | limitTo:8" class="form-control">\r\n			        <span ng-show="errorUser">Veillez sélectionner un client existant.</span>\r\n			        <hr>\r\n			        <button ng-click="edit = false; createNotification(form._id)" ng-show="edit === true" class="btn btn-success" ng-disabled="form === undefined">Envoyer</button>\r\n			    </div>\r\n			</form>\r\n		</div>\r\n		\r\n	</div>\r\n</div>'),a.put("app/fb/account/login.html",'<div ng-include="\'components/navbar/navbar-fb.html\'"></div>\n\n<div class="container">\n  <div class="row">\n    \n    <div class="col-sm-6 col-sm-offset-3 col-xs-6 col-xs-offset-3">\n      <h1>Connexion</h1>\n    </div>\n\n    <div class="col-sm-6 col-sm-offset-3 col-xs-6 col-xs-offset-3">\n\n      <form class="form" name="form" ng-submit="login(form)" novalidate>\n\n        <div class="form-group">\n          <label>Email</label>\n\n          <input type="email" name="email" class="form-control" ng-model="user.email" required>\n        </div>\n\n        <div class="form-group">\n          <label>Password</label>\n\n          <input type="password" name="password" class="form-control" ng-model="user.password" required>\n        </div>\n\n        <div class="form-group has-error">\n          <p class="help-block" ng-show="form.email.$error.required && form.password.$error.required && submitted">\n             Please enter your email and password.\n          </p>\n          <p class="help-block" ng-show="form.email.$error.email && submitted">\n             Please enter a valid email.\n          </p>\n\n          <p class="help-block">{{ errors.other }}</p>\n        </div>\n\n        <div>\n          <button class="btn btn-default btn-lg btn-login" type="submit">\n            Se connecter\n          </button>\n          <a class="btn btn-default btn-lg btn-register" href="/fb/signup">\n            Créer un compte\n          </a>\n        </div>\n\n      </form>\n    </div>\n  </div>\n  <hr>\n</div>\n'),a.put("app/fb/account/rdv.html",'<div ng-include="\'components/navbar/navbar-fb.html\'"></div>\n\n<div class="container">\n	<div class="row">\n		<div class="col-sm-12">\n			<h1>Mes rendez-vous</h1>\n		</div>\n\n		<div class="col-sm-12">\n			<table class="table">\n				<thead>\n					<tr>\n						<th>Salon</th>\n						<th>Staff</th>\n						<th>Date</th>\n						<th>Début</th>\n						<th>Fin</th>\n						<th>Prestation</th>\n					</tr>\n				</thead>\n				<tbody>\n					<tr ng-repeat="rdv in rendezvous">\n						<td>{{rdv.business.businessName}}</td>\n						<td>{{rdv.staff.staffName}}</td>\n						<td>{{rdv.startHour | date:\'fullDate\'}}</td>\n						<td>{{rdv.startHour | date:\'shortTime\'}}</td>\n						<td>{{rdv.endHour | date:\'shortTime\'}}</td>\n						<td>{{rdv.prestation.prestationRdvName}}</td>\n					</tr>\n				</tbody>\n			</table>\n		</div>\n	</div>\n</div>'),
a.put("app/fb/account/signup.html",'<div ng-include="\'components/navbar/navbar-fb.html\'"></div>\n\n<div class="container">\n  <div class="row">\n    <div class="col-sm-8 col-sm-offset-2 col-xs-10 col-xs-offset-1">\n      <h1>Inscription</h1>\n    </div>\n\n      <form class="form" name="form" ng-submit="register(form)" novalidate>\n\n        <div class="row">\n          <div class="col-sm-4 col-sm-offset-2 col-xs-5 col-xs-offset-1">\n            <!-- First name -->\n            <div class="form-group" ng-class="{ \'has-success\': form.firstName.$valid && submitted,\n                                                \'has-error\': form.firstName.$invalid && submitted }">\n              <label>Prénom <i class="fa fa-asterisk"></i></label>\n\n              <input type="text" name="firstName" class="form-control" ng-model="user.firstName"\n                     required/>\n              <p class="help-block" ng-show="form.firstName.$error.required && submitted">\n                Un prénom est requis.\n              </p>\n            </div>\n          </div>\n          <div class="col-sm-4 col-xs-5">\n            <!-- Last name -->\n            <div class="form-group" ng-class="{ \'has-success\': form.lastName.$valid && submitted,\n                                                \'has-error\': form.lastName.$invalid && submitted }">\n              <label>Nom <i class="fa fa-asterisk"></i></label>\n\n              <input type="text" name="lastName" class="form-control" ng-model="user.lastName"\n                     required/>\n              <p class="help-block" ng-show="form.lastName.$error.required && submitted">\n                Un nom est requis.\n              </p>\n            </div>\n          </div>\n        </div>\n\n\n\n\n        \n        <div class="row">\n          <!-- Email -->\n          <div class="col-sm-4 col-sm-offset-2 col-xs-5 col-xs-offset-1">\n            <div class="form-group" ng-class="{ \'has-success\': form.email.$valid && submitted,\n                                                \'has-error\': form.email.$invalid && submitted }">\n              <label>Email <i class="fa fa-asterisk"></i></label>\n\n              <input type="email" name="email" class="form-control" ng-model="user.email"\n                     required\n                     mongoose-error/>\n              <p class="help-block" ng-show="form.email.$error.email && submitted">\n                Ce n\'est pas une adresse mail valide.\n              </p>\n              <p class="help-block" ng-show="form.email.$error.required && submitted">\n                Entrez une adresse mail.\n              </p>\n              <p class="help-block" ng-show="form.email.$error.mongoose">\n                {{ errors.email }}\n              </p>\n            </div>\n          </div>\n          <div class="col-sm-4 col-xs-5">\n            <!-- Password -->\n            <div class="form-group" ng-class="{ \'has-success\': form.password.$valid && submitted,\n                                                \'has-error\': form.password.$invalid && submitted }">\n              <label>Password <i class="fa fa-asterisk"></i></label>\n\n              <input type="password" name="password" class="form-control" ng-model="user.password"\n                     ng-minlength="3"\n                     required\n                     mongoose-error/>\n              <p class="help-block"\n                 ng-show="(form.password.$error.minlength || form.password.$error.required) && submitted">\n                Le mot de passe doit contenir au moins 3 charactères.\n              </p>\n              <p class="help-block" ng-show="form.password.$error.mongoose">\n                {{ errors.password }}\n              </p>\n            </div>\n          </div>\n        </div>\n\n\n        \n\n        <!-- Date of birth & gender -->\n        <div class="row">\n            <div class="col-sm-4 col-sm-offset-2 col-xs-5 col-xs-offset-1">\n                <label>Date de naissance <i class="fa fa-asterisk"></i></label>\n                \n                <div class="form-group" ng-class="{ \'has-success\': form.dateOfBirth.$valid && submitted, \'has-error\': form.dateOfBirth.$invalid && submitted }">\n                  <p class="input-group">\n                    <input type="text" class="form-control" datepicker-popup="{{format}}" name="dateOfBirth" ng-model="user.dateOfBirth" is-open="opened" max-date="maxDate" datepicker-options="dateOptions" date-disabled="disabled(date, mode)" required mongoose-error close-text="Close" />\n                    <span class="input-group-btn">\n                      <button type="button" class="btn btn-default" ng-click="open($event)"><i class="glyphicon glyphicon-calendar"></i></button>\n                    </span>\n                  </p>\n                  <p class="help-block"\n                     ng-show="(form.password.$error.required) && submitted">\n                    Ce champ est obligatoire.\n                  </p>\n                  <p class="help-block" ng-show="form.dateOfBirth.$error.mongoose">\n                    {{ errors.dateOfBirth }}\n                  </p>\n                </div>\n            </div>\n\n            <div class="col-sm-4 col-xs-5">\n              <div class="form-group" ng-class="{ \'has-success\': form.gender.$valid && submitted, \'has-error\': form.gender.$invalid && submitted }">\n                <label>Sexe <i class="fa fa-asterisk"></i></label>\n\n                <select class="form-control" name="gender" ng-model="user.gender" required mongoose-error>\n                  <option value="homme">Homme</option>\n                  <option value="femme">Femme</option>\n                </select>\n                  <p class="help-block"\n                     ng-show="(form.password.$error.required) && submitted">\n                    Ce champ est obligatoire.\n                  </p>\n                <p class="help-block" ng-show="form.gender.$error.mongoose">\n                  {{ errors.gender }}\n                </p>\n              </div>\n            </div>\n        </div>\n\n        <!-- localite custom template -->\n        <script type="text/ng-template" id="localiteTemplate.html">\n          <a>\n            <span bind-html-unsafe="match.model.Commune | typeaheadHighlight:query"></span>\n            (<span bind-html-unsafe="match.model.NPA | typeaheadHighlight:query"></span>)\n          </a>\n        </script>\n\n        <div class="row">\n          <div class="col-sm-4 col-sm-offset-2 col-xs-4 col-xs-offset-1"><label>Localité</label>\n            <input type="text" ng-model="user.loc" ng-bind="user.loc.Commune" typeahead-min-length="3" typeahead-editable="false" typehead-on-select(model) typeahead="geodata as geodata.Commune for geodata in geodatas | filter:$viewValue" typeahead-template-url="localiteTemplate.html" class="form-control">\n          </div>\n          <div class="col-sm-2 col-xs-3"><label>NPA</label>\n            <input type="text" ng-model="user.loc" ng-bind="user.loc.NPA" typeahead-min-length="2" typeahead-editable="false" typehead-on-select(model) typeahead="geodata as geodata.NPA for geodata in geodatas | filter:$viewValue | limitTo:8" class="form-control" disabled>\n          </div>\n          <div class="col-sm-2 col-xs-3"><label>Canton</label>\n            <input type="text" ng-model="user.loc" ng-bind="user.loc.Canton" typehead-on-select(model) typeahead-editable="false" typeahead="geodata as geodata.Canton for geodata in geodatas | filter:$viewValue | limitTo:8" class="form-control" disabled>\n          </div>\n        </div>\n\n        <hr>\n        <!-- Buttons -->\n        <div class="row">\n          <div class="col-sm-4 col-sm-offset-2 col-xs-offset-1">\n            <button class="btn btn-default btn-lg btn-login" type="submit">\n              Créer un compte\n            </button>\n            <a class="btn btn-default btn-lg btn-register" href="/fb/login">\n              Se connecter\n            </a>\n          </div>\n        </div>\n\n      </form>\n  </div>\n</div>\n'),a.put("app/fb/fb.html",'<div ng-include="\'components/navbar/navbar-fb.html\'"></div>\r\n\r\n<div class="container">\r\n	<h1>Module de réservation de "{{formData.business.name}}"</h1>\r\n	<hr>\r\n\r\n	<!-- <button ng-click="fb()">test fb</button> -->\r\n\r\n	<div class="row">\r\n		<div class="col-sm-12" ng-hide="isLoggedIn()">\r\n			Veillez vous connecter afin de prendre rendez-vous chez "{{formData.business.name}}".\r\n		</div>\r\n\r\n		<div class="col-sm-12" ng-show="isLoggedIn()">\r\n\r\n\r\n			<div id="form-container">\r\n			    <div class="page-header text-center">\r\n			        <h2>Prise de rendez-vous</h2>\r\n			        \r\n			        <!-- the links to our nested states using relative paths -->\r\n			        <!-- add the active class if the state matches our ui-sref -->\r\n			        <div id="status-buttons" class="text-center">\r\n			            <div ui-sref-active="active" ui-sref="fb.step1"><span>1</span> Prestation</div>\r\n			            <div ui-sref-active="active" ui-sref="fb.step2"><span>2</span> Date</div>\r\n			            <div ui-sref-active="active" ui-sref="fb.step3"><span>3</span> Résumé</div>\r\n			        </div>\r\n			    </div>\r\n			    \r\n			    <!-- use ng-submit to catch the form submission and use our Angular function -->\r\n			    <form id="signup-form">\r\n\r\n			        <!-- our nested state views will be injected here -->\r\n			        <div id="fb-views" ui-view></div>\r\n			    </form>\r\n			</div>\r\n\r\n\r\n		</div>\r\n	</div>\r\n	\r\n</div>\r\n'),a.put("app/main/main.html",'<div ng-include="\'components/navbar/navbar.html\'"></div>\r\n\r\n<!-- Salon favori -->\r\n<header class="hero-unit" id="banner" ng-if="isLoggedIn()">\r\n  <div class="container">\r\n    <h2>Votre salon favori</h2>\r\n    <hr>\r\n    <p ng-show="currentUser.preferences.favorite === undefined">Il n\'y a pas de salon favori trouvé.</p>\r\n    <div ng-show="currentUser.preferences.favorite !== undefined">\r\n      <p>{{favoriteBusiness.name}}</p>\r\n      <p>{{favoriteBusiness.zip}} {{favoriteBusiness.city}} ({{favoriteBusiness.canton}})</p>\r\n      <a ng-href="/business/{{favoriteBusiness._id}}" class="btn btn-default btn-sm"><i class="fa fa-info"> Infos</i></a>\r\n      <a ng-href="/business/{{favoriteBusiness._id}}/rendezvous/step1" class="btn btn-default btn-sm"><i class="fa fa-book"> Rendez-vous</i></a>\r\n    </div>\r\n  </div>\r\n</header>\r\n\r\n<!-- Liste des salons -->\r\n<div class="container">\r\n  <div class="row">\r\n\r\n    <!-- when connected -->\r\n    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">\r\n      \r\n      <!-- Desktop display -->\r\n      <h1 class="page-header hidden-sm hidden-xs">Salons disponibles :</h1>\r\n      <!-- Mobile display -->\r\n      <h3 class="page-header hidden-lg hidden-md">Salons disponibles :</h3>\r\n\r\n      <div class="col-md-3 col-lg-3 hidden-sm hidden-xs" ng-repeat="business in businesses">\r\n        <div class="thumbnail no-border" ng-class="{ \'thumbnail-hover\': $index == selectedIndex }"\r\n             ng-click="itemClicked($index)">\r\n          <img src="/assets/images/2fed6ec4.businessPlaceholder.png" class="img-rounded" />\r\n          <div class="caption" id="caption-half-down">\r\n            <h4>Réservez ou visualisez les infos de ce salon !</h4>\r\n          </div>\r\n          <div class="caption" id="caption-half-up">\r\n            <a ng-href="/business/{{business._id}}" class="btn btn-default btn-sm"><i class="fa fa-info"> Infos</i></a>\r\n            <a ng-href="/business/{{business._id}}/rendezvous/step1" class="btn btn-default btn-sm" ng-show="isLoggedIn()"><i class="fa fa-book"> Rendez-vous</i></a>\r\n            <a ng-click="fav(business._id)" class="btn btn-default btn-sm" ng-show="isLoggedIn()"><i class="fa fa-star"> Favori</i></a>\r\n          </div>\r\n        </div>\r\n        <h4 class="text-center">{{business.name}}</h4>\r\n        <p class="text-center">{{business.zip}} {{business.city}} ({{business.canton}})</p>\r\n      </div>\r\n\r\n      <!-- Mobile display -->\r\n      <div class="hidden-lg hidden-md col-sm-4 col-xs-12" ng-repeat="business in businesses">\r\n        <h4 class="text-center">{{business.name}}</h4>\r\n        <p class="text-center">{{business.zip}} {{business.city}} ({{business.canton}})</p>\r\n        <div class="text-center">\r\n          <a ng-href="/business/{{business._id}}" class="btn btn-primary btn-sm btn-mgn-bottom"><i class="fa fa-info"> Infos</i></a>\r\n          <a href="/business/{{business._id}}/rendezvous/step1" class="btn btn-primary btn-sm btn-mgn-bottom" ng-show="isLoggedIn()"><i class="fa fa-book"> Rendez-vous</i></a>\r\n          <a ng-click="fav(business._id)" class="btn btn-primary btn-sm btn-mgn-bottom" ng-show="isLoggedIn()"><i class="fa fa-star"> Favori</i></a>\r\n        </div>\r\n        <hr>\r\n      </div>\r\n\r\n    </div>\r\n\r\n  </div>\r\n</div>\r\n\r\n<!-- <a ng-href="/pagetab/step1">test</a> -->\r\n\r\n<footer class="footer">\r\n  <div class="container">\r\n      <p>Direct Haircut | réalisé par Laurent Lienher, Travail de Bachelor | HEIG-VD, Ingénierie des Médias</p>\r\n  </div>\r\n</footer>\r\n'),a.put("app/rendezvous/rendezvous-step1.html",'<!-- Selection du client pour les staff -->\r\n\r\n<form name="selectUser">\r\n    <div class="form-group col-xs-10 col-sm-8 col-md-6 col-lg-4 \r\n                col-xs-offset-1 col-sm-offset-2 col-md-offset-3 col-lg-offset-4">\r\n        <h4>Sélectionner un client existant</h4>\r\n        <input type="text" ng-model="formData.user" typeahead-min-length="3" typeahead-editable="false" typeahead="user as user.name for user in users | filter:$viewValue | limitTo:8" class="form-control" required>\r\n        <span ng-show="errorUser">Veillez sélectionner un client existant.</span>\r\n    </div>\r\n</form>\r\n\r\n<div class="form-group row">\r\n    <div class="col-xs-10 col-sm-6 col-md-4 col-lg-4 \r\n    -            col-xs-offset-1 col-sm-offset-3 col-md-offset-4 col-lg-offset-4">\r\n        <button class="btn btn-block btn-info" ng-click="getPrestations(formData)" ng-disabled="formData.user === undefined">\r\n        Prochaine étape <span class="glyphicon glyphicon-circle-arrow-right"></span>\r\n        </button>\r\n    </div>\r\n</div>\r\n'),a.put("app/rendezvous/rendezvous-step2.html",'<!-- Selection de la prestation -->\r\n\r\n<h4 class="col-xs-12 col-sm-10 col-md-6 col-lg-6 col-sm-offset-1 col-md-offset-3 col-lg-offset-3">Prestations de : {{formData.business.name}}</h4>\r\n\r\n <div  class="row">\r\n    <span class="col-sm-6 col-sm-offset-3 text-danger" ng-show="errorPrestation"><i class="fa fa-times-circle"></i> Veillez sélectionner une prestation pour continuer.</span>\r\n </div>\r\n\r\n<accordion class="col-xs-12 col-sm-10 col-md-6 col-lg-6 col-sm-offset-1 col-md-offset-3 col-lg-offset-3">\r\n    <accordion-group ng-repeat="prestation in prestations" heading="{{prestation.name}} - {{prestation.duration}} mn" \r\n        close-others="true" is-open="prestation.open" ng-click="getPrice(prestation, formData.user)">\r\n        <h4>Description</h4>\r\n        <p>{{prestation.description}}</p>\r\n        <hr>\r\n\r\n        <div class="col-xs-6 hr-right">\r\n            <h4>Prix</h4>\r\n            {{formData.prestation.prices.price}} .-\r\n        </div>\r\n\r\n        <div class="col-xs-6">\r\n            <h4>Durée</h4>\r\n            {{prestation.duration}} minutes\r\n        </div>\r\n    </accordion-group>\r\n </accordion>\r\n \r\n\r\n<div class="form-group row">\r\n    <div class="col-xs-10 col-sm-6 col-md-4 col-lg-4 \r\n    -           col-xs-offset-1 col-sm-offset-3 col-md-offset-4 col-lg-offset-4">\r\n        <button class="btn btn-block btn-info" ng-click="getCalendar(formData)" ng-disabled="formData.prestation === undefined">\r\n        Prochaine étape <span class="glyphicon glyphicon-circle-arrow-right"></span>\r\n        </button>\r\n    </div>\r\n</div>'),a.put("app/rendezvous/rendezvous-step3.html",'<!-- Selection staff/date -->\r\n\r\n<div class="row">\r\n\r\n	<!-- Selection staff -->\r\n	<div id="staffs" class="col-sm-4 col-sm-offset-3" >\r\n		<h4>Sélectionner un staff</h4>\r\n		<div ng-repeat="staff in staffs">\r\n			<span ng-click="selected($index, staff)" class="cursor" ng-class="{\'selected-staff\': $index == selectedIndex}">{{staff.name}}</span>\r\n		</div>\r\n	</div>\r\n</div>\r\n\r\n<!-- calendrier -->\r\n<div class="row">\r\n	<div ui-calendar="uiConfig.calendar" class="span8 calendar" ng-model="eventSources"></div> \r\n</div>\r\n\r\n<div class="form-group row">\r\n	<div class="col-xs-10 col-sm-6 col-md-4 col-lg-4 \r\n	           col-xs-offset-1 col-sm-offset-3 col-md-offset-4 col-lg-offset-4">\r\n	    <button class="btn btn-block btn-info" ng-click="getConfirm(myRendezvous)" ng-disabled="staffWasSelected === false">\r\n	    Prochaine étape <span class="glyphicon glyphicon-circle-arrow-right"></span>\r\n	    </button>\r\n	</div>\r\n</div>\r\n\r\n\r\n'),a.put("app/rendezvous/rendezvous-step4.html","<!-- Confirmation du rendez-vous -->\r\n\r\n<div class=\"text-center\">\r\n\r\n    <div>\r\n    	<h4>Résumé du rendez-vous</h4>\r\n    	<p>{{formData.business.name}}</p>\r\n    	<p>{{formData.business.zip}} {{formData.business.city}} ({{formData.business.canton}})</p>\r\n    	<p>{{formData.street}}</p>\r\n        <hr>\r\n        <p>Le {{formData.myRendezvous[0].start | date:'d MMMM yyyy'}}</p>\r\n        <p>Débute à {{formData.myRendezvous[0].start | date:'hh:mm'}}</p>\r\n        <p>Fini dès {{formData.myRendezvous[0].end | date:'hh:mm'}}</p>\r\n        <hr>\r\n    	<p>Client : {{formData.user.name}}</p>\r\n    	<p>Prit en charge par : {{formData.staff.name}}</p>\r\n    	<p>Prestation : {{formData.prestation.name}}</p>\r\n    	<p>Prix : {{formData.prestation.prices.price}}.–</p>\r\n    	<p>Durée : {{formData.prestation.duration}} minutes</p>\r\n\r\n    </div>\r\n\r\n"+'    <button type="submit" class="btn btn-success" ng-click="bookRendezvous(formData)">Réserver</button>\r\n    <button type="submit" class="btn btn-danger" ng-click="cancelRendezvous()">Annuler</button>\r\n</div>\r\n'),a.put("app/rendezvous/rendezvous-user.html",'<div ng-include="\'components/navbar/navbar.html\'"></div>\r\n\r\n<!-- form.html -->\r\n<div class="row">\r\n<div class="col-sm-8 col-sm-offset-2">\r\n\r\n    <div id="form-container">\r\n\r\n        <div class="page-header text-center">\r\n            <h2>Prise de rendez-vous</h2>\r\n            \r\n            <!-- the links to our nested states using relative paths -->\r\n            <!-- add the active class if the state matches our ui-sref -->\r\n            <div id="status-buttons" class="text-center">\r\n                <div ui-sref-active="active" ui-sref="rendezvousUser.step1"><span>1</span> Prestation</div>\r\n                <div ui-sref-active="active" ui-sref="rendezvousUser.step2"><span>2</span> Date</div>\r\n                <div ui-sref-active="active" ui-sref="rendezvousUser.step3"><span>3</span> Résumé</div>\r\n            </div>\r\n        </div>\r\n        \r\n        <!-- use ng-submit to catch the form submission and use our Angular function -->\r\n        <form id="signup-form">\r\n\r\n            <!-- our nested state views will be injected here -->\r\n            <div id="rendezvousUser-views" ui-view></div>\r\n        </form>\r\n\r\n    </div>\r\n    \r\n</div>\r\n</div>\r\n'),a.put("app/rendezvous/rendezvous.html",'<div ng-include="\'components/navbar/navbar.html\'"></div>\n\n<!-- form.html -->\n<div class="row">\n<div class="col-sm-8 col-sm-offset-2">\n\n    <div id="form-container">\n\n        <div class="page-header text-center">\n            <h2>Prise de rendez-vous</h2>\n            \n            <!-- the links to our nested states using relative paths -->\n            <!-- add the active class if the state matches our ui-sref -->\n            <div id="status-buttons" class="text-center">\n                <div ui-sref-active="active" ui-sref="rendezvous.step1"><span>1</span> Client</div>\n                <div ui-sref-active="active" ui-sref="rendezvous.step2"><span>2</span> Prestation</div>\n                <div ui-sref-active="active" ui-sref="rendezvous.step3"><span>3</span> Date</div>\n                <div ui-sref-active="active" ui-sref="rendezvous.step4"><span>4</span> Résumé</div>\n            </div>\n        </div>\n        \n        <!-- use ng-submit to catch the form submission and use our Angular function -->\n        <form id="signup-form">\n\n            <!-- our nested state views will be injected here -->\n            <div id="rendezvous-views" ui-view></div>\n        </form>\n\n    </div>\n    \n</div>\n</div>\n'),a.put("components/modal/modal.html",'<div class="modal-header">\n  <button ng-if="modal.dismissable" type="button" ng-click="$dismiss()" class="close">&times;</button>\n  <h4 ng-if="modal.title" ng-bind="modal.title" class="modal-title"></h4>\n</div>\n<div class="modal-body">\n  <p ng-if="modal.text" ng-bind="modal.text"></p>\n  <div ng-if="modal.html" ng-bind-html="modal.html"></div>\n</div>\n<div class="modal-footer">\n  <button ng-repeat="button in modal.buttons" ng-class="button.classes" ng-click="button.click($event)" ng-bind="button.text" class="btn"></button>\n</div>'),a.put("components/navbar/navbar-fb.html",'<div class="navbar navbar-default navbar-static-top" ng-controller="NavbarCtrl">\n  <div class="container">\n    <div class="navbar-header">\n      <button class="navbar-toggle" type="button" ng-click="isCollapsed = !isCollapsed">\n        <span class="sr-only">Toggle navigation</span>\n        <span class="icon-bar"></span>\n        <span class="icon-bar"></span>\n        <span class="icon-bar"></span>\n      </button>\n      <a href="/pagetab/step1" class="navbar-brand">Directhaircut Booking App</a>\n    </div>\n    <div collapse="isCollapsed" class="navbar-collapse collapse" id="navbar-main">\n<!--       <ul class="nav navbar-nav">\n        <li ng-repeat="item in menu" ng-class="{active: isActive(item.link)}">\n            <a ng-href="{{item.link}}">{{item.title}}</a>\n        </li>\n      </ul> -->\n\n      <ul class="nav navbar-nav navbar-right">\n        <li ng-show="isLoggedIn()"><a href="#">Bienvenu {{getCurrentUser.name}}</a></li>\n        <li ng-hide="isLoggedIn()" ng-class="{active: isActive(\'/signup\')}"><a href="/fb/signup">Créer un compte</a></li>\n        <li ng-hide="isLoggedIn()" ng-class="{active: isActive(\'/login\')}"><a href="/fb/login">Se connecter</a></li>\n        <li ng-show="isLoggedIn()" ng-class="{active: isActive(\'/rendezvous\')}"><a href="/fb/rendezvous">Mes rendez-vous</a></li>\n        <!-- <li ng-show="isLoggedIn()" ng-class="{active: isActive(\'/settings\')}"><a href="/settings"><span class="glyphicon glyphicon-cog"></span></a></li> -->\n        <!-- <li ng-show="isLoggedIn()" ng-class="{active: isActive(\'/logout\')}"><a href="" ng-click="logout()">Se déconnecter</a></li> -->\n      </ul>\n    </div>\n\n  </div>\n</div>'),a.put("components/navbar/navbar.html",'<div class="navbar navbar-default navbar-static-top" ng-controller="NavbarCtrl">\r\n  <div class="container">\r\n    <div class="navbar-header">\r\n      <button class="navbar-toggle" type="button" ng-click="isCollapsed = !isCollapsed">\r\n        <span class="sr-only">Toggle navigation</span>\r\n        <span class="icon-bar"></span>\r\n        <span class="icon-bar"></span>\r\n        <span class="icon-bar"></span>\r\n      </button>\r\n      <a href="/" class="navbar-brand"><img src="/assets/images/589a404f.logo_vignette32x32.png" style="max-width:100px; margin-top: -6px;" alt="DirectHaircut"></a>\r\n    </div>\r\n    <div collapse="isCollapsed" class="navbar-collapse collapse" id="navbar-main">\r\n      <ul class="nav navbar-nav">\r\n        <li ng-repeat="item in menu" ng-class="{active: isActive(item.link)}">\r\n            <a ng-href="{{item.link}}">{{item.title}}</a>\r\n        </li>\r\n\r\n        <!-- staff menu -->\r\n        <li class="dropdown" ng-show="isStaff()">\r\n          <a href="#" ng-hide="isStaffCreated()" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Gestion du salon<span class="caret"></span></a>\r\n          <ul class="dropdown-menu">\r\n            \r\n            <li><a href="/business/show">Voir les infos du salon</a></li>\r\n            <li><a href="/business/rendezvous">Voir les rendez-vous</a></li>\r\n            <li><a href="/business/prestations">Voir les prestations</a></li>\r\n            <li><a href="/business/schedules">Voir les tranches horaires</a></li>\r\n            <li><a href="/business/staffs">Voir le personnel du salon</a></li>\r\n            <li role="separator" class="divider"></li>\r\n\r\n            <li>\r\n              <a href="/business/rendezvous/step1">\r\n                <i class="glyphicon glyphicon glyphicon-book" aria-hidden="true"></i>\r\n                Prendre un rendez-vous\r\n              </a>\r\n            </li>\r\n            <li>\r\n              <a href="/business/fb-page">\r\n                <i class="glyphicon glyphicon glyphicon-pencil" aria-hidden="true"></i>\r\n                Gérer la page Facebook\r\n              </a>\r\n            </li>\r\n          </ul>\r\n        </li>\r\n      </ul>\r\n\r\n      <ul class="nav navbar-nav navbar-right">\r\n        <li ng-hide="isLoggedIn()" ng-class="{active: isActive(\'/signup\')}"><a href="/signup">Créer un compte</a></li>\r\n        <li ng-hide="isLoggedIn()" ng-class="{active: isActive(\'/login\')}"><a href="/login">Se connecter</a></li>\r\n        <li ng-show="isBusinessCreated()" ng-class="{active: isActive(\'/createBusiness\')}"><a href="/createBusiness">Créer salon</a></li>\r\n        <li ng-show="isStaffCreated()" ng-class="{active: isActive(\'/createStaff\')}"><a href="/createStaff">Créer staff</a></li>\r\n        <li ng-show="isLoggedIn()" ng-class="{active: isActive(\'/myRendezvous\')}"><a href="/myRendezvous">Mes rendez-vous</a></li>\r\n        <li ng-show="isLoggedIn()" ng-class="{active: isActive(\'/notifs\')}"><a href="/notifs"><span class="glyphicon glyphicon-envelope"></span></a></li>\r\n        <li ng-show="isLoggedIn()" ng-class="{active: isActive(\'/settings\')}"><a href="/settings"><span class="glyphicon glyphicon-cog"></span></a></li>\r\n        <li ng-show="isLoggedIn()" ng-class="{active: isActive(\'/logout\')}"><a href="" ng-click="logout()">Se déconnecter</a></li>\r\n      </ul>\r\n    </div>\r\n\r\n  </div>\r\n</div>\r\n')}]);